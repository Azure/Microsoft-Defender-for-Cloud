{
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": {
      "type": "string",
      "defaultValue": "DefenderforDevOps (Preview)",
      "metadata": {
        "description": "The friendly name for the workbook that is used in the Gallery or Saved List.  This name must be unique within a resource group."
      }
    },
    "workbookType": {
      "type": "string",
      "defaultValue": "workbook",
      "metadata": {
        "description": "The gallery that the workbook will been shown under. Supported values include workbook, tsg, etc. Usually, this is 'workbook'"
      }
    },
    "workbookSourceId": {
      "type": "string",
      "defaultValue": "Azure Security Center",
      "metadata": {
        "description": "The id of resource instance to which the workbook will be associated"
      }
    },
    "workbookId": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "metadata": {
        "description": "The unique guid for this workbook instance"
      }
    }
  },
  "variables": {
    "workbookContent": {
      "version": "Notebook/1.0",
      "items": [
        {
          "type": 1,
          "content": {
            "json": "#  Defender for DevOps\r\n\r\n"
          },
          "customWidth": "50",
          "name": "text - 1"
        },
        {
          "type": 9,
          "content": {
            "version": "KqlParameterItem/1.0",
            "parameters": [
              {
                "id": "c88e6e5a-d64e-4065-98a0-63772188ff5e",
                "version": "KqlParameterItem/1.0",
                "name": "Help",
                "label": "Show Help",
                "type": 10,
                "description": "Show insturctions for using this workbook",
                "isRequired": true,
                "typeSettings": {
                  "additionalResourceOptions": []
                },
                "jsonData": "[[\r\n { \"value\": \"Yes\", \"label\": \"Yes\"},\r\n {\"value\": \"No\", \"label\": \"No\", \"selected\":true }\r\n]",
                "timeContext": {
                  "durationMs": 86400000
                }
              }
            ],
            "style": "above",
            "queryType": 12
          },
          "name": "parameters - 15"
        },
        {
          "type": 1,
          "content": {
            "json": "#### Navigate\r\nClick on one of the tabs below to explore each area:\r\n* Overview - Summary view of code, secrets, OSS vulnerabilities, and posture scan results\r\n* Secrets - View of exposed secrets in repositories\r\n* Code - View of code scanning results in repositories\r\n* OSS Vulnerabilities - View of OSS vulnerabilities in repositories\r\n* Infrastructure as Code - View of IaC misconfigurations in repositories\r\n* Posture - Consolidated view of security posture across connected DevOps environments\r\n* Threats & Tactics - Summarized view of attack exposure across connected DevOps environments",
            "style": "info"
          },
          "conditionalVisibility": {
            "parameterName": "Help",
            "comparison": "isEqualTo",
            "value": "Yes"
          },
          "name": "NavInstructions"
        },
        {
          "type": 1,
          "content": {
            "json": "#### Welcome to DevOps assessment findings workbook\r\nThis workbook is based on the following recommendations provided by Defender for Cloud:\r\n* [Code repositories should have code scanning findings resolved](http://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/c68a8c2a-6ed4-454b-9e37-4b7654f2165f)\r\n* [Code repositories should have secret scanning findings resolved](http://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27)\r\n* [Code repositories should have Dependabot scanning findings resolved](http://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/822425e3-827f-4f35-bc33-33749257f851)\r\n* [Code repositories should have infrastructure as code scanning findings resolved](http://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/2ebc815f-7bc7-4573-994d-e1cc46fb4a35)\r\n* [GitHub repositories should have code scanning enabled](http://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/6672df26-ff2e-4282-83c3-e2f20571bd11)\r\n* [GitHub repositories should have secret scanning enabled](http://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/1a600c61-6443-4ab4-bd28-7a6b6fb4691d)\r\n* [GitHub repositories should have Dependabot scanning enabled](http://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/92643c1f-1a95-4b68-bbd2-5117f92d6e35)",
            "style": "info"
          },
          "conditionalVisibility": {
            "parameterName": "Help",
            "comparison": "isEqualTo",
            "value": "Yes"
          },
          "name": "text - 12"
        },
        {
          "type": 11,
          "content": {
            "version": "LinkItem/1.0",
            "style": "tabs",
            "links": [
              {
                "id": "28d59a80-f8b1-4a7f-a53e-0342585e1468",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Overview",
                "subTarget": "OverviewTab",
                "style": "link"
              },
              {
                "id": "e9b65feb-9f81-4b66-80df-c9d409a4a404",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Secrets",
                "subTarget": "SecretsTab",
                "style": "link"
              },
              {
                "id": "8bd0e53b-a116-4be3-8fc8-dda761cdf784",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Code",
                "subTarget": "CodeTab",
                "style": "link"
              },
              {
                "id": "456aa2a6-cfb0-4ebd-b615-a7fc9088081d",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "OSS Vulnerabilities",
                "subTarget": "OSSTab",
                "style": "link"
              },
              {
                "id": "74d23e32-f683-468d-a517-1e542f466a55",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Infrastructure as Code",
                "subTarget": "IaCTab",
                "style": "link"
              },
              {
                "id": "b6712143-8444-41a3-8669-064143c52e62",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Posture",
                "subTarget": "PostureTab",
                "style": "link"
              },
              {
                "id": "7059f3ed-1f5b-412f-aeef-5c06da8acdf9",
                "cellValue": "SelectedTab",
                "linkTarget": "parameter",
                "linkLabel": "Threats & Tactics",
                "subTarget": "ThreatsTab",
                "style": "link"
              }
            ]
          },
          "name": "Tabs"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27\"\r\n| extend VulId = tostring(properties.id), Severity = tostring(properties.status.severity), Status = tostring(properties.status.code)\r\n| where Status == 'Unhealthy'\r\n| summarize Count = dcount(VulId) by Severity",
            "size": 4,
            "title": "Secrets Exposed",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "tiles",
            "tileSettings": {
              "titleContent": {
                "columnMatch": "Severity",
                "formatter": 4,
                "formatOptions": {
                  "palette": "redBright"
                },
                "numberFormat": {
                  "unit": 0,
                  "options": {
                    "style": "decimal"
                  }
                }
              },
              "leftContent": {
                "columnMatch": "Count",
                "formatter": 12,
                "formatOptions": {
                  "palette": "redGreen"
                },
                "numberFormat": {
                  "unit": 17,
                  "options": {
                    "style": "decimal",
                    "maximumFractionDigits": 2,
                    "maximumSignificantDigits": 3
                  }
                }
              },
              "showBorder": true,
              "sortCriteriaField": "Severity"
            },
            "chartSettings": {
              "seriesLabelSettings": [
                {
                  "seriesName": "High",
                  "color": "redBright"
                },
                {
                  "seriesName": "Medium",
                  "color": "yellow"
                },
                {
                  "seriesName": "Unknown",
                  "color": "blueDark"
                }
              ]
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "OverviewTab"
          },
          "customWidth": "20",
          "name": "SecretsExposed"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\"\r\n| extend VulId = tostring(properties.id), Severity = tostring(properties.status.severity), Status = tostring(properties.status.code)\r\n| where Status == 'Unhealthy'\r\n| summarize Count = dcount(VulId) by Severity",
            "size": 1,
            "title": "Code Scanning Recommendations by Severity",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "piechart",
            "gridSettings": {
              "formatters": [
                {
                  "columnMatch": "Resource",
                  "formatter": 0,
                  "formatOptions": {
                    "customColumnWidthSetting": "22ch"
                  }
                },
                {
                  "columnMatch": "sevH",
                  "formatter": 4,
                  "formatOptions": {
                    "min": 0,
                    "palette": "redBright",
                    "compositeBarSettings": {
                      "labelText": "",
                      "columnSettings": []
                    },
                    "customColumnWidthSetting": "15ch"
                  }
                },
                {
                  "columnMatch": "sevM",
                  "formatter": 4,
                  "formatOptions": {
                    "min": 0,
                    "palette": "yellow",
                    "customColumnWidthSetting": "15ch"
                  }
                },
                {
                  "columnMatch": "sevL",
                  "formatter": 4,
                  "formatOptions": {
                    "min": 0,
                    "palette": "blueDark",
                    "customColumnWidthSetting": "15ch"
                  }
                }
              ]
            },
            "chartSettings": {
              "seriesLabelSettings": [
                {
                  "seriesName": "Medium",
                  "color": "yellow"
                },
                {
                  "seriesName": "High",
                  "color": "redBright"
                },
                {
                  "seriesName": "Low",
                  "color": "blueDark"
                }
              ]
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "OverviewTab"
          },
          "customWidth": "40",
          "name": "CodeScanningBySeverity"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| where name == \"1a600c61-6443-4ab4-bd28-7a6b6fb4691d\" or name == \"6672df26-ff2e-4282-83c3-e2f20571bd11\" or name == \"92643c1f-1a95-4b68-bbd2-5117f92d6e35\" or name == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\" or name == \"580dbad4-33c2-44c8-a37d-22874d8ef4c3\" or name == \"0db7ca3c-bd65-4244-9be3-2194c13a3893\" or name == \"822425e3-827f-4f35-bc33-33749257f851\" or name == \"4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27\" or name == \"92643c1f-1a95-4b68-bbd2-5117f92d6e35\" or name == \"2ebc815f-7bc7-4573-994d-e1cc46fb4a35\"\r\n| extend Status = tostring(properties.status.code)\r\n| where Status == 'Unhealthy'\r\n| project assessmentKey=name, parse_json(properties)\r\n| where properties.metadata.severity in ('Low','Medium','High')\r\n| extend SeverityRank = case(\r\n    properties.metadata.severity == 'High', 3,\r\n    properties.metadata.severity == 'Medium', 2,\r\n    properties.metadata.severity == 'Low', 1,\r\n    0)\r\n| project-away SeverityRank\r\n| extend Severity = properties.metadata.severity\r\n| project Severity = tostring(Severity)\r\n| summarize Count = count() by Severity",
            "size": 1,
            "title": "All DevOps Recommendations by Severity",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "piechart",
            "chartSettings": {
              "seriesLabelSettings": [
                {
                  "seriesName": "Medium",
                  "color": "yellow"
                },
                {
                  "seriesName": "High",
                  "color": "redBright"
                },
                {
                  "seriesName": "Low",
                  "color": "blueDark"
                }
              ]
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "OverviewTab"
          },
          "customWidth": "40",
          "name": "DevOpsAssessmentsBySeverity"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27\"\r\n| extend Repository = split(id, '/')[10]\r\n| extend VulId = tostring(properties.id), Severity = tostring(properties.status.severity), Status = tostring(properties.status.code)\r\n| where Status == 'Unhealthy'\r\n| project Repository",
            "size": 1,
            "title": "Repositories with secrets exposed",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "table",
            "gridSettings": {
              "formatters": [
                {
                  "columnMatch": "Repository",
                  "formatter": 1
                },
                {
                  "columnMatch": "RepoName",
                  "formatter": 1
                }
              ]
            },
            "tileSettings": {
              "titleContent": {
                "columnMatch": "RepoName",
                "formatter": 3,
                "formatOptions": {
                  "palette": "coldHot"
                }
              },
              "showBorder": true,
              "size": "auto"
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "OverviewTab"
          },
          "customWidth": "20",
          "name": "ReposWithSecrets"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\"\r\n| project Resource = tolower(extract(@'(?i)(.*?)/providers/Microsoft.Security/([^/]+)', 1, id)), subscriptionId, Severity = tostring(properties.status.severity), Status = tostring(properties.status.code), VulnId = tostring(properties.id)\r\n| where Status == 'Unhealthy'\r\n| summarize dcount(VulnId) by Resource, Severity, VulnId\r\n| summarize Total=count(Severity), sevH=countif(Severity=='High'), sevM=countif(Severity=='Medium'), sevL=countif(Severity=='Low') by Resource\r\n| order by sevH desc\r\n",
            "size": 1,
            "title": "Code vulnerabilities by severity -Top 5 at risk repositories",
            "noDataMessage": "No unhealthy repositories found",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "gridSettings": {
              "formatters": [
                {
                  "columnMatch": "Resource",
                  "formatter": 13,
                  "formatOptions": {
                    "linkTarget": null,
                    "showIcon": true
                  }
                },
                {
                  "columnMatch": "sevH",
                  "formatter": 4,
                  "formatOptions": {
                    "min": 0,
                    "palette": "redBright",
                    "compositeBarSettings": {
                      "labelText": "",
                      "columnSettings": []
                    },
                    "customColumnWidthSetting": "15ch"
                  }
                },
                {
                  "columnMatch": "sevM",
                  "formatter": 4,
                  "formatOptions": {
                    "min": 0,
                    "palette": "yellow",
                    "customColumnWidthSetting": "15ch"
                  }
                },
                {
                  "columnMatch": "sevL",
                  "formatter": 4,
                  "formatOptions": {
                    "min": 0,
                    "palette": "blueDark",
                    "customColumnWidthSetting": "15ch"
                  }
                }
              ],
              "rowLimit": 5
            },
            "sortBy": []
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "OverviewTab"
          },
          "customWidth": "40",
          "name": "CodeVulnsBySeverity"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\" or assessmentKey == \"580dbad4-33c2-44c8-a37d-22874d8ef4c3\" or assessmentKey == \"0db7ca3c-bd65-4244-9be3-2194c13a3893\" or assessmentKey == \"822425e3-827f-4f35-bc33-33749257f851\" or assessmentKey == \"4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27\" or assessmentKey == \"2ebc815f-7bc7-4573-994d-e1cc46fb4a35\"\r\n| project Resource = tolower(extract(@'(?i)(.*?)/providers/Microsoft.Security/([^/]+)', 1, id)), subscriptionId, Severity = tostring(properties.status.severity), Status = tostring(properties.status.code), VulnId = tostring(properties.id)\r\n| where Status == 'Unhealthy'\r\n| summarize dcount(VulnId) by Resource, Severity, VulnId\r\n| summarize Total=count(Severity), sevH=countif(Severity=='High'), sevM=countif(Severity=='Medium'), sevL=countif(Severity=='Low') by Resource",
            "size": 1,
            "title": "DevOps vulnerabilities by severity -Top 5 at risk repositories",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "gridSettings": {
              "formatters": [
                {
                  "columnMatch": "Resource",
                  "formatter": 13,
                  "formatOptions": {
                    "linkTarget": null,
                    "showIcon": true
                  }
                },
                {
                  "columnMatch": "sevH",
                  "formatter": 4,
                  "formatOptions": {
                    "min": 0,
                    "palette": "redBright",
                    "compositeBarSettings": {
                      "labelText": "",
                      "columnSettings": []
                    },
                    "customColumnWidthSetting": "15ch"
                  }
                },
                {
                  "columnMatch": "sevM",
                  "formatter": 4,
                  "formatOptions": {
                    "min": 0,
                    "palette": "yellow",
                    "customColumnWidthSetting": "15ch"
                  }
                },
                {
                  "columnMatch": "sevL",
                  "formatter": 4,
                  "formatOptions": {
                    "min": 0,
                    "palette": "blueDark",
                    "customColumnWidthSetting": "15ch"
                  }
                }
              ],
              "rowLimit": 5,
              "sortBy": [
                {
                  "itemKey": "$gen_bar_sevH_2",
                  "sortOrder": 1
                }
              ],
              "labelSettings": [
                {
                  "columnId": "sevH",
                  "label": "High"
                },
                {
                  "columnId": "sevM",
                  "label": "Medium"
                },
                {
                  "columnId": "sevL",
                  "label": "Low"
                }
              ]
            },
            "sortBy": [
              {
                "itemKey": "$gen_bar_sevH_2",
                "sortOrder": 1
              }
            ]
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "OverviewTab"
          },
          "customWidth": "40",
          "name": "DevOpsVulnsBySeverity"
        },
        {
          "type": 1,
          "content": {
            "json": "---"
          },
          "name": "text - 11"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27\"\r\n| extend Repository = tostring(split(id, '/')[12]),\r\n    Secret = tostring(properties.status.description)\r\n    //Tool = case(tostring(properties.additionalData.data.Tool_name) == \"\",\"Other\", properties.additionalData.data.Tool_name)\r\n| summarize count(Repository) by Secret",
            "size": 0,
            "title": "Count by Secret Type",
            "queryType": 1,
            "resourceType": "microsoft.resources/tenants",
            "crossComponentResources": [
              "value::tenant"
            ],
            "visualization": "piechart"
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "SecretsTab"
          },
          "name": "query - 25"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27\"\r\n| extend Repository = split(id, '/')[10],\r\n    VulId = tostring(properties.id), Severity = tostring(properties.status.severity), Status = tostring(properties.status.code),\r\n    Secret = properties.status.description,\r\n    Properties = properties\r\n| project Repository, Status, Severity, Secret, Properties",
            "size": 0,
            "title": "Secret scanning",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "gridSettings": {
              "formatters": [
                {
                  "columnMatch": "Repository",
                  "formatter": 13,
                  "formatOptions": {
                    "linkTarget": null,
                    "showIcon": true
                  }
                },
                {
                  "columnMatch": "Status",
                  "formatter": 18,
                  "formatOptions": {
                    "thresholdsOptions": "icons",
                    "thresholdsGrid": [
                      {
                        "operator": "==",
                        "thresholdValue": "Healthy",
                        "representation": "success",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "==",
                        "thresholdValue": "Unhealthy",
                        "representation": "2",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "==",
                        "thresholdValue": "NotApplicable",
                        "representation": "1",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "Default",
                        "thresholdValue": null,
                        "representation": "success",
                        "text": "{0}{1}"
                      }
                    ]
                  }
                },
                {
                  "columnMatch": "Severity",
                  "formatter": 1
                },
                {
                  "columnMatch": "Secret",
                  "formatter": 1
                }
              ]
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "SecretsTab"
          },
          "name": "SecretResults"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\"\r\n| extend Repository = split(id, '/')[10],\r\n    Finding = tostring(properties.status.description),\r\n    Tool = case(tostring(properties.additionalData.data.Tool_name) == \"\",\"Unknown\", properties.additionalData.data.Tool_name)\r\n| summarize count(Finding) by Tool",
            "size": 0,
            "title": "Count Findings by Tool",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "piechart",
            "tileSettings": {
              "showBorder": false,
              "titleContent": {
                "columnMatch": "Tool",
                "formatter": 1
              },
              "leftContent": {
                "columnMatch": "count_Finding",
                "formatter": 12,
                "formatOptions": {
                  "palette": "auto"
                },
                "numberFormat": {
                  "unit": 17,
                  "options": {
                    "maximumSignificantDigits": 3,
                    "maximumFractionDigits": 2
                  }
                }
              }
            },
            "graphSettings": {
              "type": 0,
              "topContent": {
                "columnMatch": "Tool",
                "formatter": 1
              },
              "centerContent": {
                "columnMatch": "count_Finding",
                "formatter": 1,
                "numberFormat": {
                  "unit": 17,
                  "options": {
                    "maximumSignificantDigits": 3,
                    "maximumFractionDigits": 2
                  }
                }
              }
            },
            "chartSettings": {
              "showMetrics": false,
              "showLegend": true,
              "seriesLabelSettings": [
                {
                  "seriesName": "Unknown",
                  "label": "Unknown"
                }
              ]
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "CodeTab"
          },
          "customWidth": "33",
          "name": "query - 26"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\"\r\n| extend Repository = tostring(split(id, '/')[12]),\r\n    Finding = tostring(properties.status.description),\r\n    Tool = tostring(properties.additionalData.data.Tool_name),\r\n    TimeGenerated = todatetime(properties.timeGenerated)\r\n| summarize count(Finding) by Repository, TimeGenerated, Tool",
            "size": 0,
            "title": "Count Findings by Repository",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "barchart",
            "chartSettings": {
              "showLegend": true,
              "customThresholdLine": "10",
              "customThresholdLineStyle": 2
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "CodeTab"
          },
          "customWidth": "66",
          "name": "query - 27"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\"\r\n| extend Repository = split(id, '/')[12],\r\n    Finding = tostring(properties.status.description),\r\n    Status = tostring(properties.status.code),\r\n    Severity = tostring(properties.status.severity),\r\n    Tool = tostring(properties.additionalData.data.Tool_name),\r\n    Properties = properties\r\n| project Repository, Severity, Status, Finding, Tool, Properties",
            "size": 0,
            "title": "Code scanning by severity",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "gridSettings": {
              "formatters": [
                {
                  "columnMatch": "Repository",
                  "formatter": 1
                },
                {
                  "columnMatch": "Status",
                  "formatter": 18,
                  "formatOptions": {
                    "thresholdsOptions": "icons",
                    "thresholdsGrid": [
                      {
                        "operator": "==",
                        "thresholdValue": "Healthy",
                        "representation": "success",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "==",
                        "thresholdValue": "Unhealthy",
                        "representation": "2",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "==",
                        "thresholdValue": "NotApplicable",
                        "representation": "1",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "Default",
                        "thresholdValue": null,
                        "representation": "success",
                        "text": "{0}{1}"
                      }
                    ]
                  }
                }
              ],
              "rowLimit": 300,
              "hierarchySettings": {
                "treeType": 1,
                "groupBy": [
                  "Repository"
                ],
                "finalBy": "Severity"
              }
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "CodeTab"
          },
          "name": "CodeScanningResults"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"822425e3-827f-4f35-bc33-33749257f851\"\r\n| extend VulId = tostring(properties.id), Severity = tostring(properties.status.severity), Status = tostring(properties.status.code)\r\n| where Status == 'Unhealthy'\r\n| summarize Count = dcount(VulId) by Severity",
            "size": 0,
            "title": "OSS Vulnerabilities by severity",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "piechart",
            "chartSettings": {
              "seriesLabelSettings": [
                {
                  "seriesName": "High",
                  "color": "redBright"
                },
                {
                  "seriesName": "Medium",
                  "color": "yellow"
                },
                {
                  "seriesName": "Low",
                  "color": "blueDark"
                }
              ]
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "OSSTab"
          },
          "customWidth": "33",
          "name": "OSSVulnerabilitiesGraph"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"822425e3-827f-4f35-bc33-33749257f851\"\r\n| extend Repository = tostring(split(id, '/')[12]),\r\n    Finding = tostring(properties.status.description),\r\n    Tool = tostring(properties.additionalData.data.Tool_name),\r\n    TimeGenerated = todatetime(properties.timeGenerated)\r\n| summarize count(Finding) by Repository, TimeGenerated, Tool",
            "size": 0,
            "title": "Count Findings by Repository",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "barchart",
            "chartSettings": {
              "customThresholdLine": "5",
              "customThresholdLineStyle": 2
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "OSSTab"
          },
          "customWidth": "66",
          "name": "query - 27"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"822425e3-827f-4f35-bc33-33749257f851\"\r\n| extend Repository = split(id, '/')[12],\r\n    Finding = tostring(properties.status.description),\r\n    Status = tostring(properties.status.code),\r\n    Severity = tostring(properties.status.severity),\r\n    Package = tostring(properties.additionalData.data.securityVulnerability__package__ecosystem),\r\n    Summary = tostring(properties.additionalData.data.securityAdvisory__summary),\r\n    Properties = properties\r\n| project Repository, Severity,  Status, Summary, Package, Finding, Properties",
            "size": 0,
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "gridSettings": {
              "formatters": [
                {
                  "columnMatch": "Repository",
                  "formatter": 13,
                  "formatOptions": {
                    "linkTarget": null,
                    "showIcon": true
                  }
                },
                {
                  "columnMatch": "Severity",
                  "formatter": 1
                },
                {
                  "columnMatch": "Status",
                  "formatter": 18,
                  "formatOptions": {
                    "thresholdsOptions": "icons",
                    "thresholdsGrid": [
                      {
                        "operator": "==",
                        "thresholdValue": "Healthy",
                        "representation": "success",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "==",
                        "thresholdValue": "Unhealthy",
                        "representation": "2",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "==",
                        "thresholdValue": "NotApplicable",
                        "representation": "1",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "Default",
                        "thresholdValue": null,
                        "representation": "success",
                        "text": "{0}{1}"
                      }
                    ]
                  }
                },
                {
                  "columnMatch": "Summary",
                  "formatter": 1
                },
                {
                  "columnMatch": "Package",
                  "formatter": 1
                },
                {
                  "columnMatch": "Finding",
                  "formatter": 1
                }
              ],
              "hierarchySettings": {
                "treeType": 1,
                "groupBy": [
                  "Repository"
                ]
              }
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "OSSTab"
          },
          "name": "OSSVulnerabilitiesResults"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"2ebc815f-7bc7-4573-994d-e1cc46fb4a35\"\r\n| extend Repository = split(id, '/')[12],\r\n    Finding = tostring(properties.status.description),\r\n    Tool = case(tostring(properties.additionalData.data.Tool_name) == \"\",\"Unknown\", properties.additionalData.data.Tool_name)\r\n| summarize count(Finding) by Tool",
            "size": 0,
            "title": "Findings by Tool",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "piechart"
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "IaCTab"
          },
          "customWidth": "33",
          "name": "IaCSummaryResults"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"2ebc815f-7bc7-4573-994d-e1cc46fb4a35\"\r\n| extend Repository = tostring(split(id, '/')[12]),\r\n    Finding = tostring(properties.status.description),\r\n    Tool = tostring(properties.additionalData.data.Tool_name),\r\n    TimeGenerated = todatetime(properties.timeGenerated)\r\n| summarize count(Finding) by Repository, TimeGenerated, Tool",
            "size": 0,
            "title": "Count Findings by Repository",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "barchart",
            "chartSettings": {
              "customThresholdLine": "10",
              "customThresholdLineStyle": 2
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "IaCTab"
          },
          "customWidth": "66",
          "name": "query - 26"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments/subassessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| where assessmentKey == \"2ebc815f-7bc7-4573-994d-e1cc46fb4a35\"\r\n| extend Repository = split(id, '/')[12],\r\n    Finding = tostring(properties.status.description),\r\n    Status = tostring(properties.status.code),\r\n    Severity = tostring(properties.status.severity),\r\n    Package = tostring(properties.additionalData.data.securityVulnerability__package__ecosystem),\r\n    Summary = tostring(properties.additionalData.data.securityAdvisory__summary),\r\n    Properties = properties\r\n| project Repository, Severity,  Status, Summary, Package, Finding, Properties",
            "size": 0,
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "gridSettings": {
              "hierarchySettings": {
                "treeType": 1,
                "groupBy": [
                  "Repository"
                ]
              }
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "IaCTab"
          },
          "name": "IaCResults"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| where name == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\" \r\n     or name == \"4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27\" \r\n     or name == \"822425e3-827f-4f35-bc33-33749257f851\"\r\n     or name == \"2ebc815f-7bc7-4573-994d-e1cc46fb4a35\" \r\n     or name == \"6672df26-ff2e-4282-83c3-e2f20571bd11\"\r\n     or name == \"1a600c61-6443-4ab4-bd28-7a6b6fb4691d\" \r\n     or name == \"92643c1f-1a95-4b68-bbd2-5117f92d6e35\"\r\n| extend Status = tostring(properties.status.code)\r\n| where Status == 'Unhealthy'\r\n| project assessmentKey=name, parse_json(properties)\r\n| where properties.metadata.severity in ('Low','Medium','High')\r\n| extend SeverityRank = case(\r\n    properties.metadata.severity == 'High', 3,\r\n    properties.metadata.severity == 'Medium', 2,\r\n    properties.metadata.severity == 'Low', 1,\r\n    0)\r\n| project-away SeverityRank\r\n| extend Severity = properties.metadata.severity\r\n| project Severity = tostring(Severity)\r\n| summarize Count = count() by Severity",
            "size": 0,
            "title": "Security posture by severity",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "piechart",
            "chartSettings": {
              "seriesLabelSettings": [
                {
                  "seriesName": "High",
                  "color": "redBright"
                },
                {
                  "seriesName": "Medium",
                  "color": "yellow"
                },
                {
                  "seriesName": "Low",
                  "color": "blueDark"
                }
              ]
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "PostureTab"
          },
          "customWidth": "33",
          "name": "SecurityPostureGraph"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| extend assessmentKey = extract(\".*assessments/(.+?)/.*\",1,  id)\r\n| extend Repository = tostring(split(properties.resourceDetails.Id,\"/\",12))\r\n| extend Status = tostring(properties.status.code)\r\n| extend TimeGenerated = todatetime(properties.timeGenerated)\r\n| where Status == 'Unhealthy'\r\n| where name == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\" \r\n     or name == \"4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27\" \r\n     or name == \"822425e3-827f-4f35-bc33-33749257f851\"\r\n     or name == \"2ebc815f-7bc7-4573-994d-e1cc46fb4a35\" \r\n     or name == \"6672df26-ff2e-4282-83c3-e2f20571bd11\"\r\n     or name == \"1a600c61-6443-4ab4-bd28-7a6b6fb4691d\" \r\n     or name == \"92643c1f-1a95-4b68-bbd2-5117f92d6e35\"\r\n| summarize count(name) by trim(@'^\\[\"|\"]$',Repository)",
            "size": 0,
            "title": "Posture Assessments by Repository",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "barchart"
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "PostureTab"
          },
          "customWidth": "66",
          "name": "query - 28"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| extend assessmentKey = name\r\n| where assessmentKey == \"1a600c61-6443-4ab4-bd28-7a6b6fb4691d\" or assessmentKey == \"6672df26-ff2e-4282-83c3-e2f20571bd11\" or assessmentKey == \"92643c1f-1a95-4b68-bbd2-5117f92d6e35\"\r\n| extend Repository = split(id, '/')[10],\r\n    Description = tostring(properties.status.description),\r\n    Status = tostring(properties.status.code),\r\n    Severity = tostring(properties.metadata.severity),\r\n    Properties = properties\r\n| project Repository, Description, Status, Severity, Properties",
            "size": 0,
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "gridSettings": {
              "formatters": [
                {
                  "columnMatch": "Repository",
                  "formatter": 1
                },
                {
                  "columnMatch": "Description",
                  "formatter": 1
                },
                {
                  "columnMatch": "Status",
                  "formatter": 18,
                  "formatOptions": {
                    "thresholdsOptions": "icons",
                    "thresholdsGrid": [
                      {
                        "operator": "==",
                        "thresholdValue": "Healthy",
                        "representation": "success",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "==",
                        "thresholdValue": "Unhealthy",
                        "representation": "2",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "==",
                        "thresholdValue": "NotApplicable",
                        "representation": "1",
                        "text": "{0}{1}"
                      },
                      {
                        "operator": "Default",
                        "thresholdValue": null,
                        "representation": "success",
                        "text": "{0}{1}"
                      }
                    ]
                  }
                },
                {
                  "columnMatch": "Severity",
                  "formatter": 1
                },
                {
                  "columnMatch": "Environment",
                  "formatter": 1
                }
              ],
              "hierarchySettings": {
                "treeType": 1,
                "groupBy": [
                  "Repository",
                  "Severity"
                ]
              }
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "PostureTab"
          },
          "name": "SecurityPosture"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| where name == \"1a600c61-6443-4ab4-bd28-7a6b6fb4691d\" or name == \"6672df26-ff2e-4282-83c3-e2f20571bd11\" or name == \"92643c1f-1a95-4b68-bbd2-5117f92d6e35\" or name == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\" or name == \"580dbad4-33c2-44c8-a37d-22874d8ef4c3\" or name == \"0db7ca3c-bd65-4244-9be3-2194c13a3893\" or name == \"822425e3-827f-4f35-bc33-33749257f851\" or name == \"4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27\" or name == \"92643c1f-1a95-4b68-bbd2-5117f92d6e35\"\r\n| extend Repository = tostring(split(id, '/')[12]), \r\n    Threats = tostring(strcat_array(properties.metadata.threats,\",\")), \r\n    Tactics = tostring(strcat_array(properties.metadata.tactics,\",\"))\r\n| project Repository, Threats, Tactics\r\n| summarize count() by Threats",
            "size": 0,
            "title": "Threats & Tactics",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "piechart"
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "ThreatsTab"
          },
          "customWidth": "33",
          "name": "query - 22"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| where name == \"1a600c61-6443-4ab4-bd28-7a6b6fb4691d\" or name == \"6672df26-ff2e-4282-83c3-e2f20571bd11\" or name == \"92643c1f-1a95-4b68-bbd2-5117f92d6e35\" or name == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\" or name == \"580dbad4-33c2-44c8-a37d-22874d8ef4c3\" or name == \"0db7ca3c-bd65-4244-9be3-2194c13a3893\" or name == \"822425e3-827f-4f35-bc33-33749257f851\" or name == \"4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27\" or name == \"92643c1f-1a95-4b68-bbd2-5117f92d6e35\"\r\n| extend Repository = tostring(split(id, '/')[12]), \r\n    Threats = tostring(strcat_array(properties.metadata.threats,\",\")), \r\n    Tactics = tostring(strcat_array(properties.metadata.tactics,\",\"))\r\n| project Repository, Threats, Tactics\r\n| summarize count(Threats) by Repository",
            "size": 0,
            "title": " Threats & Tactics by Repository",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "barchart",
            "chartSettings": {
              "showMetrics": false,
              "showLegend": true,
              "customThresholdLine": "5",
              "customThresholdLineStyle": 1
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "ThreatsTab"
          },
          "customWidth": "66",
          "name": "query - 23"
        },
        {
          "type": 3,
          "content": {
            "version": "KqlItem/1.0",
            "query": "securityresources\r\n| where type == \"microsoft.security/assessments\"\r\n| where name == \"1a600c61-6443-4ab4-bd28-7a6b6fb4691d\" or name == \"6672df26-ff2e-4282-83c3-e2f20571bd11\" or name == \"92643c1f-1a95-4b68-bbd2-5117f92d6e35\" or name == \"c68a8c2a-6ed4-454b-9e37-4b7654f2165f\" or name == \"580dbad4-33c2-44c8-a37d-22874d8ef4c3\" or name == \"0db7ca3c-bd65-4244-9be3-2194c13a3893\" or name == \"822425e3-827f-4f35-bc33-33749257f851\" or name == \"4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27\" or name == \"92643c1f-1a95-4b68-bbd2-5117f92d6e35\"\r\n| extend Repository = tostring(split(id, '/')[10]), \r\n        Threats = tostring(strcat_array(properties.metadata.threats,\",\")), \r\n        Tactics = tostring(strcat_array(properties.metadata.tactics,\",\")), \r\n        Techniques = tostring(strcat_array(properties.metadata.techniques,\",\")),\r\n        Properties = properties\r\n| project Repository, Threats, Tactics, Techniques, Properties",
            "size": 0,
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources",
            "crossComponentResources": [
              "value::all"
            ],
            "visualization": "table",
            "gridSettings": {
              "formatters": [
                {
                  "columnMatch": "Threats",
                  "formatter": 1
                },
                {
                  "columnMatch": "Tactics",
                  "formatter": 1
                }
              ],
              "hierarchySettings": {
                "treeType": 1,
                "groupBy": [
                  "Repository"
                ]
              }
            },
            "sortBy": [],
            "tileSettings": {
              "showBorder": false,
              "titleContent": {
                "columnMatch": "Threats",
                "formatter": 1
              },
              "leftContent": {
                "columnMatch": "count_",
                "formatter": 12,
                "formatOptions": {
                  "palette": "auto"
                },
                "numberFormat": {
                  "unit": 17,
                  "options": {
                    "maximumSignificantDigits": 3,
                    "maximumFractionDigits": 2
                  }
                }
              }
            },
            "graphSettings": {
              "type": 0,
              "topContent": {
                "columnMatch": "Threats",
                "formatter": 1
              },
              "centerContent": {
                "columnMatch": "count_",
                "formatter": 1,
                "numberFormat": {
                  "unit": 17,
                  "options": {
                    "maximumSignificantDigits": 3,
                    "maximumFractionDigits": 2
                  }
                }
              }
            },
            "chartSettings": {
              "seriesLabelSettings": [
                {
                  "seriesName": "[\"MissingCoverage\",\"ThreatResistance\"]",
                  "color": "blue"
                },
                {
                  "seriesName": "[\"AccountBreach\"]",
                  "color": "magenta"
                },
                {
                  "color": "purple"
                }
              ]
            },
            "mapSettings": {
              "locInfo": "LatLong",
              "sizeSettings": "count_",
              "sizeAggregation": "Sum",
              "legendMetric": "count_",
              "legendAggregation": "Sum",
              "itemColorSettings": {
                "type": "heatmap",
                "colorAggregation": "Sum",
                "nodeColorField": "count_",
                "heatmapPalette": "greenRed"
              }
            }
          },
          "conditionalVisibility": {
            "parameterName": "SelectedTab",
            "comparison": "isEqualTo",
            "value": "ThreatsTab"
          },
          "name": "ThreatsAndTactics"
        }
      ],
      "fallbackResourceIds": [
        "Azure Security Center"
      ]
    }
  },
  "resources": [
    {
      "name": "[parameters('workbookId')]",
      "type": "microsoft.insights/workbooks",
      "location": "[resourceGroup().location]",
      "apiVersion": "2021-03-08",
      "dependsOn": [],
      "kind": "shared",
      "properties": {
        "displayName": "[parameters('workbookDisplayName')]",
        "serializedData": "[string(variables('workbookContent'))]",
        "version": "1.0",
        "sourceId": "[parameters('workbookSourceId')]",
        "category": "[parameters('workbookType')]"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "value": "[resourceId( 'microsoft.insights/workbooks', parameters('workbookId'))]"
    }
  },
  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"
}