{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
      "workbookDisplayName": {
        "type": "String",
        "defaultValue": "Network Security Dashboard",
        "metadata": {
          "description": ""
        }
      }
    },
    "resources": [
      {
        "type": "microsoft.insights/workbooks",
        "apiVersion": "2018-06-17-preview",
        "name": "[guid(resourceGroup().id, deployment().name)]",
        "location": "[resourceGroup().location]",
        "kind": "shared",
        "identity": {
            "type": "None"
        },
        "properties": {
          "displayName": "[parameters('workbookDisplayName')]",
          "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"## Network Security Dashboard for Security Center\"},\"name\":\"text - 0\"},{\"type\":1,\"content\":{\"json\":\"<svg viewBox=\\\"0 0 19 19\\\" width=\\\"20\\\" class=\\\"fxt-escapeShadow\\\" role=\\\"presentation\\\" focusable=\\\"false\\\" xmlns:svg=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" aria-hidden=\\\"true\\\"><g><path fill=\\\"#1b93eb\\\" d=\\\"M16.82 8.886c0 4.81-5.752 8.574-7.006 9.411a.477.477 0 01-.523 0C8.036 17.565 2.18 13.7 2.18 8.886V3.135a.451.451 0 01.42-.419C7.2 2.612 6.154.625 9.5.625s2.3 1.987 6.8 2.091a.479.479 0 01.523.419z\\\"></path><path fill=\\\"url(#0024423711759027356)\\\" d=\\\"M16.192 8.99c0 4.392-5.333 7.947-6.483 8.575a.319.319 0 01-.418 0c-1.15-.732-6.483-4.183-6.483-8.575V3.762a.575.575 0 01.313-.523C7.2 3.135 6.258 1.357 9.4 1.357s2.2 1.882 6.274 1.882a.45.45 0 01.419.418z\\\"></path><path d=\\\"M9.219 5.378a.313.313 0 01.562 0l.875 1.772a.314.314 0 00.236.172l1.957.284a.314.314 0 01.174.535l-1.416 1.38a.312.312 0 00-.09.278l.334 1.949a.313.313 0 01-.455.33l-1.75-.92a.314.314 0 00-.292 0l-1.75.92a.313.313 0 01-.455-.33L7.483 9.8a.312.312 0 00-.09-.278L5.977 8.141a.314.314 0 01.174-.535l1.957-.284a.314.314 0 00.236-.172z\\\" class=\\\"msportalfx-svg-c01\\\"></path></g></svg>&nbsp;<span style=\\\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\\\"> Please take time to answer a quick survey,\\r\\n</span>[<span style=\\\"font-family: Open Sans; font-weight: 620; font-size: 14px;font-style: bold;margin:-10px 0px 0px 0px;position: relative;top:-3px;left:-4px;\\\"> click here. </span>](http://aka.ms/NetSecWorkbookSurvey)\"},\"name\":\"Survey\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"f650f0bc-dd38-45db-8837-7133061a3784\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Subscription\",\"type\":6,\"isRequired\":true,\"multiSelect\":true,\"quote\":\"'\",\"delimiter\":\",\",\"value\":[\"value::all\"],\"typeSettings\":{\"additionalResourceOptions\":[\"value::all\"],\"includeAll\":true},\"timeContext\":{\"durationMs\":86400000}},{\"id\":\"e59a6815-d20e-4969-a943-d1505cf016d9\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"Info\",\"type\":10,\"isRequired\":true,\"value\":\"Off\",\"typeSettings\":{\"additionalResourceOptions\":[],\"showDefault\":false},\"jsonData\":\"[\\r\\n { \\\"value\\\": \\\"Off\\\", \\\"label\\\": \\\"Off\\\"},\\r\\n { \\\"value\\\": \\\"FAQ\\\", \\\"label\\\": \\\"FAQ\\\"},\\r\\n { \\\"value\\\": \\\"Change Log\\\", \\\"label\\\": \\\"Change Log\\\"}\\r\\n]\"}],\"style\":\"above\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\"},\"name\":\"Parameters\"},{\"type\":1,\"content\":{\"json\":\"### Change Log \\r\\n\\r\\n|Version|Description|\\r\\n|---|---|\\r\\n|v1.0| Public availability of network security dashboard| \",\"style\":\"info\"},\"conditionalVisibility\":{\"parameterName\":\"Info\",\"comparison\":\"isEqualTo\",\"value\":\"Change Log\"},\"name\":\"ChangeLog\"},{\"type\":1,\"content\":{\"json\":\"### FAQ\\r\\n\\r\\nUse this workbook to have an aggrgated view across your all network security resources including security recommendations!\\r\\n\\r\\n#### Q: What is the data source for this workbook?\\r\\n* **Answer**: This workbook utlizes Azure Resource Graph (ARG) queries to show real-time network security and network assests and thier configuration.\\r\\n\\r\\n#### Q: Can I edit or update the queries in the workbook?\\r\\n* **Answer**: Yes, you can customize this workbook and its queries by clicking on the editing the workbook and then clicking on the Edit button for a specific query you want to update.\\r\\n\\r\\n#### Q: How do I get future versions of this workbook?\\r\\n* **Answer**:  This workbook is available on the ASC community repository (GitHub), any new versions will be available at [this](https://github.com/Azure/Azure-Security-Center/tree/main/Workbooks) location and you will be able to re-deploy a new version anytime you want.\\r\\n\\r\\n#### Q: How do I provide feedback?\\r\\n* **Answer**: You can provide feedback by using the attached survey link in the top section of the workbook or by clicking [here](http://aka.ms/NetSecWorkbookSurvey).\\r\\n\\r\\n#### Q: How do I get support?\\r\\n* **Answer**: All artifacts within the ASC community repository are provided as is, without SLA or official support. However, if you have an issue please fill out a [bug report](https://github.com/Azure/Azure-Security-Center/issues/new?assignees=&labels=&template=bug_report.md&title=Network security workbook) and the community will try to solve it.\",\"style\":\"info\"},\"conditionalVisibility\":{\"parameterName\":\"Info\",\"comparison\":\"isEqualTo\",\"value\":\"FAQ\"},\"name\":\"FAQ\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"10327716-beb4-4f57-912c-8d7a06ec26f0\",\"cellValue\":\"SelectedView\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Overview\",\"subTarget\":\"Overview\",\"style\":\"link\"},{\"id\":\"0afbd0cc-9ef6-4208-b0bd-48432e4ea4c1\",\"cellValue\":\"SelectedView\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Public IPs & Exposed Ports\",\"subTarget\":\"PublicIPsView\",\"style\":\"link\"},{\"id\":\"5ebdcd81-36a4-4b6f-b386-4a5826d2acb3\",\"cellValue\":\"SelectedView\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Network Security Services\",\"subTarget\":\"NetSecSvcView\",\"style\":\"link\"},{\"id\":\"397241cf-b5e7-489a-855e-6931ae783261\",\"cellValue\":\"SelectedView\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Internal Networking\",\"subTarget\":\"InternalNetworkingView\",\"style\":\"link\"},{\"id\":\"eed7f5e2-cad9-4dc1-bc53-419f8374be8d\",\"cellValue\":\"SelectedView\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Gateway/VPN services\",\"subTarget\":\"GatewayVPNView\",\"style\":\"link\"},{\"id\":\"97d3c78c-6f12-47bf-b9d1-aed0f69e711b\",\"cellValue\":\"SelectedView\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Traffic Manager\",\"subTarget\":\"TrafficManagerView\",\"style\":\"link\"},{\"id\":\"863d7ca0-7a51-44d4-989c-fc8806548be8\",\"cellValue\":\"SelectedView\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Security Recommendations\",\"subTarget\":\"RecommendationsView\",\"style\":\"link\"}]},\"name\":\"MainMenu\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"76abf4ed-da91-4865-a568-882444316830\",\"cellValue\":\"SelectedSubMenu\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Public IP and Asset Types\",\"subTarget\":\"PublicIPAssetTypes\",\"style\":\"link\"},{\"id\":\"1726eac9-b3f3-4420-8bb7-37dd8675f462\",\"cellValue\":\"SelectedSubMenu\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Ports Exposed to the Internet\",\"subTarget\":\"PortsExposed\",\"style\":\"link\"}]},\"name\":\"links - 2\"},{\"type\":1,\"content\":{\"json\":\"This view presents inbound rules on different Azure resources. Please view each table to see rule configuration and ports that are open.\\r\\n\\r\\n---\\r\\n\\r\\n**As a security best practice, reduce the number of ports exposed to the internet to reduce the risk vulnerabilities and attacks. [Learn more](https://docs.microsoft.com/en-us/azure/security/fundamentals/network-best-practices)**\",\"style\":\"upsell\"},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"PortsExposed\"},\"name\":\"PortsExposedBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/azurefirewalls\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend ipConfigurations = properties.ipConfigurations\\r\\n| extend FirewallSKU = tostring(properties.sku.tier)\\r\\n| where FirewallSKU contains \\\"Standard\\\"\\r\\n| extend natRuleCollections = properties.natRuleCollections\\r\\n| where natRuleCollections contains \\\"\\\"\\r\\n| mv-expand bagexpansion=array natRuleCollections\\r\\n| extend natRules = natRuleCollections.properties.rules\\r\\n| mv-expand bagexpansion=array natRules\\r\\n| extend DNATRuleName = tostring(natRules.name)\\r\\n| extend DNATRuleFirewallPort = tostring(natRules.destinationPorts)\\r\\n| extend DNATRuleFirewallIP = tostring(natRules.destinationAddresses)\\r\\n| extend DNATRuleSourceIP = tostring(natRules.sourceAddresses)\\r\\n| extend DNATRuleSourceIPGroup = tostring(natRules.sourceIpGroups)\\r\\n| extend DNATRuleDestinationIP = tostring(natRules.translatedAddress)\\r\\n| extend DNATRuleDestinationPort = tostring(natRules.translatedPort)\\r\\n| extend DNATRuleProtocol = tostring(natRules.protocols)\\r\\n| project-away kind, managedBy, plan, properties, identity, zones, extendedLocation, ipConfigurations, natRuleCollections, natRules, tenantId, tags, sku, name, resourceGroup, apiVersion\",\"size\":0,\"title\":\"DNAT Rules on Azure Firewall Standard with Classic Rules\",\"noDataMessage\":\"No Azure Firewal Std. were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"subnetid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"FirewallSKU\"},{\"columnId\":\"DNATRuleName\"},{\"columnId\":\"DNATRuleFirewallPort\"},{\"columnId\":\"DNATRuleFirewallIP\"},{\"columnId\":\"DNATRuleSourceIP\"},{\"columnId\":\"DNATRuleSourceIPGroup\"},{\"columnId\":\"DNATRuleDestinationIP\"},{\"columnId\":\"DNATRuleDestinationPort\"},{\"columnId\":\"DNATRuleProtocol\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"PortsExposed\"},\"name\":\"DNAT Rules on Azure Firewall Standard\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/firewallpolicies\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend PolicySKU = tostring(properties.sku.tier)\\r\\n| extend Firewalls = properties.firewalls\\r\\n| extend RCGroups = properties.ruleCollectionGroups\\r\\n| mvexpand bagexpansion=array RCGroups, Firewalls\\r\\n| extend FirewallId = Firewalls.id\\r\\n| extend DNATRuleCollectionGroupId = RCGroups.id\\r\\n| where DNATRuleCollectionGroupId contains \\\"Dnat\\\"\\r\\n| project-away kind, managedBy, sku, plan, properties, zones, extendedLocation, RCGroups, Firewalls, tags, identity, tenantId, name, resourceGroup\\r\\n\",\"size\":0,\"title\":\"DNAT Rule Collection Groups in Azure Firewall Standard and Premium Policy\",\"noDataMessage\":\"No Azure Firewall Policies were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"FirewallId\",\"formatter\":13,\"formatOptions\":{\"linkColumn\":\"FirewallId\",\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"DNATRuleCollectionGroupId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"PolicySKU\",\"label\":\"Policy SKU\"},{\"columnId\":\"FirewallId\",\"label\":\"Firewall\"},{\"columnId\":\"DNATRuleCollectionGroupId\",\"label\":\"DNAT Rule Collection Group\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"PortsExposed\"},\"name\":\"DNAT Rule Collection Groups in Standard and Premium Policy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains 'publicIPAddresses' and isnotempty(properties.ipAddress)\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend publicipaddress = tostring(properties.ipAddress)\\r\\n| extend sku = tostring(sku.name)\\r\\n| extend pipallocationmethod = tostring(properties.publicIPAllocationMethod)\\r\\n| extend ipConfiguration = parse_json(properties.ipConfiguration.id)\\r\\n| extend BrkipConfig = split(ipConfiguration, '/')\\r\\n| extend assetprovider = tostring(BrkipConfig[6])\\r\\n| extend typeassetassociatedwith = iif(isempty(tostring(BrkipConfig[7])),\\\"not associated\\\",tostring(BrkipConfig[7]))\\r\\n| extend nameassetassociatedwith = substring(properties.ipConfiguration.id, 0, indexof(properties.ipConfiguration.id, '/ipConfigurations'))\\r\\n| extend dnsname = tostring(properties.dnsSettings.fqdn)\\r\\n| project-away name, tenantId, kind, resourceGroup, managedBy, apiVersion, plan, properties, tags, identity, zones, extendedLocation, ipConfiguration, BrkipConfig, assetprovider, sku\\r\\n//| project Resource = id, location, publicipaddress, pipallocationmethod, dnsname, sku, nameassetassociatedwith, typeassetassociatedwith, subscriptionId, ResourceGroup = RG\",\"size\":2,\"title\":\"List of Public IPs\",\"noDataMessage\":\"No Public IPs were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"pipallocationmethod\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"Static\",\"representation\":\"more\"},{\"operator\":\"==\",\"thresholdValue\":\"Dynamic\",\"representation\":\"Normal\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"Blank\",\"text\":\"{0}{1}\"}],\"compositeBarSettings\":{\"labelText\":\"\",\"columnSettings\":[]}}},{\"columnMatch\":\"typeassetassociatedwith\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"resourceGroup\",\"formatter\":14,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"rowLimit\":5000,\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"publicipaddress\",\"label\":\"Public IP Address\"},{\"columnId\":\"pipallocationmethod\",\"label\":\"Allocation Method\"},{\"columnId\":\"typeassetassociatedwith\",\"label\":\"Associated with Type\"},{\"columnId\":\"nameassetassociatedwith\",\"label\":\"Associated with Resource\"},{\"columnId\":\"dnsname\",\"label\":\"DNS Name\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"PublicIPAssetTypes\"},\"name\":\"PublicIPs\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/frontdoors\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend FrontDoorId = tostring(properties.frontdoorId)\\r\\n| extend FrontDoorDNSName = tostring(properties.cName)\\r\\n| extend FrontDoorFriendlyName = tostring(properties.friendlyName)\\r\\n| extend FrontDoorResourceState = tostring(properties.resourceState)\\r\\n| extend frontendEndpoints = properties.frontendEndpoints.[0]\\r\\n| extend routingRules = properties.routingRules.[0]\\r\\n| extend backendPools = properties.backendPools.[0]\\r\\n| extend FrontendHostName = tostring(frontendEndpoints.properties.hostName)\\r\\n| extend FrontendWAFPolicyId = frontendEndpoints.properties.webApplicationFirewallPolicyLink.id\\r\\n| extend FrontendConfigName = tostring(frontendEndpoints.name)\\r\\n| extend FrontendResourceState = tostring(frontendEndpoints.properties.resourceState)\\r\\n| extend FrontendResourceId = frontendEndpoints.id\\r\\n| extend RoutingProtocol = routingRules.properties.acceptedProtocols\\r\\n| extend RoutingPattern = routingRules.properties.patternsToMatch\\r\\n| mvexpand bagexpansion=array RoutingProtocol, RoutingPattern\\r\\n| extend RoutingResourceState = tostring(routingRules.properties.resourceState)\\r\\n| extend backends = backendPools.properties.backends.[0]\\r\\n| extend BackendAddress = tostring(backends.address)\\r\\n| extend BackendHTTPPort = tostring(backends.httpPort)\\r\\n| extend BackendHTTPSPort = tostring(backends.httpsPort)\\r\\n| extend BackendCertNameCheck = tostring(properties.backendPoolsSettings.enforceCertificateNameCheck)\\r\\n| extend BackendSendRecvTimeoutSeconds = tostring(properties.backendPoolsSettings.sendRecvTimeoutSeconds)\\r\\n| extend BackendHostHeader = tostring(backends.backendHostHeader)\\r\\n| extend BackendPoolName = tostring(backendPools.name)\\r\\n| extend BackendResourceState = tostring(backendPools.properties.resourceState)\\r\\n| extend BackendResourceId = backendPools.id\\r\\n| project-away kind, managedBy, sku, plan, properties, identity, zones, extendedLocation, frontendEndpoints, routingRules, backendPools, backends, tenantId, tags, name, resourceGroup\",\"size\":0,\"title\":\"Front Door Rules\",\"noDataMessage\":\"No Front Doors were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"FrontendWAFPolicyId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"FrontendResourceId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"BackendResourceId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"resourceGroup\",\"formatter\":14,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"FrontDoorId\",\"label\":\"FrontDoor Id\"},{\"columnId\":\"FrontDoorDNSName\",\"label\":\"FrontDoor DNS Name\"},{\"columnId\":\"FrontDoorFriendlyName\"},{\"columnId\":\"FrontDoorResourceState\"},{\"columnId\":\"FrontendHostName\"},{\"columnId\":\"FrontendWAFPolicyId\"},{\"columnId\":\"FrontendConfigName\"},{\"columnId\":\"FrontendResourceState\"},{\"columnId\":\"FrontendResourceId\"},{\"columnId\":\"RoutingProtocol\"},{\"columnId\":\"RoutingPattern\"},{\"columnId\":\"RoutingResourceState\"},{\"columnId\":\"BackendAddress\"},{\"columnId\":\"BackendHTTPPort\"},{\"columnId\":\"BackendHTTPSPort\"},{\"columnId\":\"BackendCertNameCheck\"},{\"columnId\":\"BackendSendRecvTimeoutSeconds\"},{\"columnId\":\"BackendHostHeader\"},{\"columnId\":\"BackendPoolName\"},{\"columnId\":\"BackendResourceState\"},{\"columnId\":\"BackendResourceId\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"PortsExposed\"},\"name\":\"FrontDoorRules\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/applicationgateway\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend backendAddressPools = properties.backendAddressPools\\r\\n| extend frontendIPConfigurations = properties.frontendIPConfigurations\\r\\n| extend frontendPorts = properties.frontendPorts\\r\\n| extend backendHttpSettingsCollection = properties.backendHttpSettingsCollection\\r\\n| extend httpListeners = properties.httpListeners\\r\\n| mv-expand bagexpansion=array frontendIPConfigurations, frontendPorts, backendAddressPools, backendHttpSettingsCollection\\r\\n| extend PIPid = tostring(frontendIPConfigurations.properties.publicIPAddress.id)\\r\\n| join ( Resources | where type=='microsoft.network/publicipaddresses' | extend PublicIPAddress=tostring(properties.ipAddress) | project PIPid=id,PublicIPAddress ) on PIPid\\r\\n| extend ListenerPort = tostring(frontendPorts.properties.port)\\r\\n| extend BackendPoolName = tostring(backendAddressPools.name)\\r\\n| extend BackendPoolIPAddress = tostring(backendAddressPools.properties.backendAddresses.[0].ipAddress)\\r\\n| extend BackendPoolFQDN = tostring(backendAddressPools.properties.backendAddresses.[0].fqdn)\\r\\n| extend BackendPort = tostring(backendHttpSettingsCollection.properties.port)\\r\\n| extend BackendProtocol = tostring(backendHttpSettingsCollection.properties.protocol)\\r\\n| extend HTTPHostName = tostring(backendHttpSettingsCollection.properties.hostName)\\r\\n| project-away frontendIPConfigurations, frontendPorts, httpListeners, backendAddressPools, backendHttpSettingsCollection, PIPid, PIPid1, extendedLocation, zones, identity, properties, managedBy, kind, tenantId, tags, name, sku, plan, resourceGroup\",\"size\":0,\"title\":\"Application Gateway Rules\",\"noDataMessage\":\"No Application Gateways were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"PublicIPAddress\"},{\"columnId\":\"ListenerPort\"},{\"columnId\":\"BackendPoolName\"},{\"columnId\":\"BackendPort\"},{\"columnId\":\"BackendProtocol\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"PortsExposed\"},\"name\":\"ApplicationGatewayRules\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains 'microsoft.network/loadbalancers'\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend loadBalancingRules = properties.loadBalancingRules\\r\\n| extend NatRules = properties.inboundNatRules\\r\\n| extend frontendIPConfig = properties.frontendIPConfigurations\\r\\n| mv-expand bagexpansion=array loadBalancingRules, NatRules\\r\\n| extend LBrulename = tostring(loadBalancingRules.name)\\r\\n| extend LBruleprotocol = tostring(loadBalancingRules.properties.protocol)\\r\\n| extend LBrulefrontendPort = tostring(loadBalancingRules.properties.frontendPort)\\r\\n| extend LBrulebackendPort = tostring(loadBalancingRules.properties.backendPort)\\r\\n| extend LBrulebackendPool = tostring(loadBalancingRules.properties.backendAddressPool.id)\\r\\n| extend Natrulename = tostring(NatRules.name)\\r\\n| extend Natruleprotocol = tostring(NatRules.properties.protocol)\\r\\n| extend NatrulefrontendPort = tostring(NatRules.properties.frontendPort)\\r\\n| extend NatrulebackendPort = tostring(NatRules.properties.backendPort)\\r\\n| extend NatrulebackendConfig = NatRules.properties.backendIPConfiguration.id\\r\\n| extend frontendIPConfig = properties.frontendIPConfigurations\\r\\n| mv-expand bagexpansion=array frontendIPConfig\\r\\n| extend frontendIPAllocation = tostring(frontendIPConfig.properties.privateIPAllocationMethod)\\r\\n| extend frontendprivateIPAddress = tostring(frontendIPConfig.properties.privateIPAddress)\\r\\n| extend frontendpublicIPResource = tostring(frontendIPConfig.properties.publicIPAddress.id)\\r\\n| join ( Resources | where type=='microsoft.network/publicipaddresses' | extend frontendPublicIPAddress=tostring(properties.ipAddress) | project frontendpublicIPResource=id,frontendPublicIPAddress ) on frontendpublicIPResource\\r\\n| project-away kind, managedBy, apiVersion, identity, zones, frontendpublicIPResource, frontendpublicIPResource1, tenantId, properties, tags, extendedLocation, plan, loadBalancingRules, NatRules, frontendIPConfig, name, resourceGroup, sku\",\"size\":0,\"title\":\"Load Balancer Inbound NAT Rules\",\"noDataMessage\":\"No Load Balancers were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"LBrulebackendPool\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"NatrulebackendConfig\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"LBrulename\",\"label\":\"LB Rule Name\"},{\"columnId\":\"LBruleprotocol\",\"label\":\"\"},{\"columnId\":\"LBrulefrontendPort\"},{\"columnId\":\"LBrulebackendPort\"},{\"columnId\":\"LBrulebackendPool\"},{\"columnId\":\"Natrulename\"},{\"columnId\":\"Natruleprotocol\"},{\"columnId\":\"NatrulefrontendPort\"},{\"columnId\":\"NatrulebackendPort\"},{\"columnId\":\"NatrulebackendConfig\"},{\"columnId\":\"frontendIPAllocation\"},{\"columnId\":\"frontendprivateIPAddress\"},{\"columnId\":\"frontendPublicIPAddress\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"PortsExposed\"},\"name\":\"LoadBalancerRules\"},{\"type\":1,\"content\":{\"json\":\"As a security best practice, reduce the number of “any-any” rules on your network security groups (NSGs). Check the [All network ports should be restricted on network security groups associated to your virtual machine](https://ms.portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/3b20e985-f71f-483b-b078-f30d73936d43) recommendation to view unhealthy resources alongside with remediation steps.\",\"style\":\"upsell\"},\"name\":\"NetworkPortsBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains 'microsoft.network/Networksecuritygroups'\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend nic = properties.networkInterfaces\\r\\n| mv-expand nic\\r\\n| extend NICId = nic.id\\r\\n| extend udrulesubnetids = properties.subnets\\r\\n| extend udrules = properties.securityRules\\r\\n| mv-expand udrules\\r\\n| extend UserDefinedRuleName = tostring(udrules.name)\\r\\n| extend UDRuleProtocol = tostring(udrules.properties.protocol)\\r\\n| extend UDRuleDestinationPort = tostring(udrules.properties.destinationPortRange)\\r\\n| extend UDRuleDestinationPortList = tostring(udrules.properties.destinationPortRanges)\\r\\n| extend UDRuleDirection = tostring(udrules.properties.direction)\\r\\n| extend UDRuleSourceNetwork = tostring(udrules.properties.sourceAddressPrefix)\\r\\n| extend UDRuleDestinationNetwork = tostring(udrules.properties.destinationAddressPrefix)\\r\\n| extend UDRuleAccess = tostring(udrules.properties.access)\\r\\n| project-away udrules, kind, managedBy, nic, identity, zones, name, tenantId, tags, extendedLocation, properties, sku, plan, udrulesubnetids, resourceGroup\",\"size\":0,\"title\":\"Network Security Group Inbound Security Rules\",\"noDataMessage\":\"No NSGs were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"NICId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"udrulenicid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}}],\"rowLimit\":5000,\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"NICId\"},{\"columnId\":\"UserDefinedRuleName\"},{\"columnId\":\"UDRuleProtocol\"},{\"columnId\":\"UDRuleDestinationPort\"},{\"columnId\":\"UDRuleDestinationPortList\"},{\"columnId\":\"UDRuleDirection\"},{\"columnId\":\"UDRuleSourceNetwork\"},{\"columnId\":\"UDRuleDestinationNetwork\"},{\"columnId\":\"UDRuleAccess\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"PortsExposed\"},\"name\":\"NSGRules\"}]},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"PublicIPsView\"},\"name\":\"PortsPublicIP\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"9a80c38d-b158-4483-9380-bcdfd898dc79\",\"cellValue\":\"SelectedSubMenu\",\"linkTarget\":\"parameter\",\"linkLabel\":\"DDoS Protection Plans\",\"subTarget\":\"DDoS\",\"style\":\"link\"},{\"id\":\"38937ced-0f1a-4c38-bc4f-9cea6b910d2f\",\"cellValue\":\"SelectedSubMenu\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Azure Firewalls and Firewall Policies\",\"subTarget\":\"Firewall\",\"style\":\"link\"},{\"id\":\"0f1707b6-87fe-4de0-8077-1b2dd55fc5e0\",\"cellValue\":\"SelectedSubMenu\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Azure WAF Policies\",\"subTarget\":\"WAF\",\"style\":\"link\"},{\"id\":\"751ca64a-7060-4df9-b96d-34061751f1f0\",\"cellValue\":\"SelectedSubMenu\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Network Security Groups\",\"subTarget\":\"NSG\",\"style\":\"link\"}]},\"name\":\"NetSecSubMenu\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/ddosprotectionplans\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend virtualNetworks = properties.virtualNetworks\\r\\n| mvexpand bagexpansion=array virtualNetworks\\r\\n| extend VNETid = virtualNetworks.id\\r\\n| project-away kind, managedBy, sku, plan, identity, zones, extendedLocation, name, tenantId, properties, tags, virtualNetworks, resourceGroup\",\"size\":0,\"title\":\"DDoS Protection Plans with Virtual Networks\",\"noDataMessage\":\"No DDoS Protection Plans were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"VNETid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"VNETid\",\"label\":\"Virtual Networks\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"DDoS\"},\"name\":\"DDoSPlans\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type == \\\"microsoft.network/frontdoorwebapplicationfirewallpolicies\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend WAFPolicyName = name\\r\\n| extend FrontDoorEndpoint = properties.frontendEndpointLinks.[0].id\\r\\n| extend WAFMode = tostring(properties.policySettings.mode)\\r\\n| extend CustomBlockResponseCode = tostring(properties.policySettings.customBlockResponseStatusCode)\\r\\n| extend CustomBlockResponseBody = tostring(properties.policySettings.customBlockResponseBody)\\r\\n| extend RedirectURL = properties.policySettings.redirectUrl\\r\\n| extend ManagedRuleSets = properties.managedRules.managedRuleSets\\r\\n| mvexpand bagexpansion=array ManagedRuleSets\\r\\n| extend ManagedRuleSetVersion = tostring(ManagedRuleSets.ruleSetVersion)\\r\\n| extend ManagedRuleSetType = tostring(ManagedRuleSets.ruleSetType)\\r\\n| extend ManagedRuleSetExclusions = tostring(ManagedRuleSets.exclusions)\\r\\n| extend ManagedRuleSetGroupOverrides = tostring(ManagedRuleSets.ruleGroupOverrides)\\r\\n| extend CustomRules = tostring(properties.customRules.rules)\\r\\n| project-away kind, managedBy, sku, plan, properties, identity, zones, extendedLocation, ManagedRuleSets, tenantId, tags, name, resourceGroup\",\"size\":0,\"title\":\"Front Door WAF Policies\",\"noDataMessage\":\"No Front Door WAF Policies were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"FrontDoorEndpoint\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"WAFPolicyName\",\"label\":\"WAF Policy Name\"},{\"columnId\":\"FrontDoorEndpoint\",\"label\":\"Front Door Endpoint\"},{\"columnId\":\"WAFMode\",\"label\":\"WAF Mode\"},{\"columnId\":\"CustomBlockResponseCode\"},{\"columnId\":\"CustomBlockResponseBody\"},{\"columnId\":\"RedirectURL\"},{\"columnId\":\"ManagedRuleSetVersion\"},{\"columnId\":\"ManagedRuleSetType\"},{\"columnId\":\"ManagedRuleSetExclusions\"},{\"columnId\":\"ManagedRuleSetGroupOverrides\"},{\"columnId\":\"CustomRules\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"WAF\"},\"name\":\"FrontDoorWAFPolicy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type == \\\"microsoft.network/applicationgatewaywebapplicationfirewallpolicies\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend AppGWid = properties.applicationGateways.[0].id\\r\\n| extend WAFMode = tostring(properties.policySettings.mode)\\r\\n| extend MaxRequestBodySizeInKB = tostring(properties.policySettings.maxRequestBodySizeInKb)\\r\\n| extend FileUploadLimitInMB = tostring(properties.policySettings.fileUploadLimitInMb)\\r\\n| extend RequestBodyCheck = tostring(properties.policySettings.requestBodyCheck)\\r\\n| extend ManagedRulesExclusions = tostring(properties.managedRules.exclusions)\\r\\n| extend ManagedRuleSets = properties.managedRules.managedRuleSets\\r\\n| mvexpand bagexpansion=array ManagedRuleSets\\r\\n| extend ManagedRuleSetVersion = tostring(ManagedRuleSets.ruleSetVersion)\\r\\n| extend ManagedRuleSetType = tostring(ManagedRuleSets.ruleSetType)\\r\\n| extend ManagedRuleSetGroupOverrides = tostring(ManagedRuleSets.ruleGroupOverrides)\\r\\n| extend CustomRules = tostring(properties.customRules)\\r\\n| project-away kind, managedBy, sku, plan, properties, identity, zones, extendedLocation, ManagedRuleSets, tenantId, name, tags, resourceGroup\",\"size\":0,\"title\":\"Application Gateway WAF Policies\",\"noDataMessage\":\"No Application Gateway WAF Policies were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"AppGWid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Location\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"AppGWid\",\"label\":\"Application Gateway\"},{\"columnId\":\"WAFMode\",\"label\":\"WAF Mode\"},{\"columnId\":\"MaxRequestBodySizeInKB\"},{\"columnId\":\"FileUploadLimitInMB\"},{\"columnId\":\"RequestBodyCheck\"},{\"columnId\":\"ManagedRulesExclusions\"},{\"columnId\":\"ManagedRuleSetVersion\"},{\"columnId\":\"ManagedRuleSetType\"},{\"columnId\":\"ManagedRuleSetGroupOverrides\"},{\"columnId\":\"CustomRules\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"WAF\"},\"name\":\"AppGatewayWAFPolicy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/azurefirewalls\\\"\\r\\n| extend ResourceGroup = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend ipConfigurations = properties.ipConfigurations\\r\\n| extend FirewallSKU = tostring(properties.sku.tier)\\r\\n| extend ThreatIntelMode = tostring(properties.threatIntelMode)\\r\\n| extend DNSConfig = properties.additionalProperties\\r\\n| mv-expand bagexpansion=array ipConfigurations\\r\\n| extend PIPid = tostring(ipConfigurations.properties.publicIPAddress.id)\\r\\n| join ( Resources | where type=='microsoft.network/publicipaddresses' | extend PublicIPAddress=tostring(properties.ipAddress) | project PIPid=id,PublicIPAddress ) on PIPid\\r\\n| extend PrivateIP = tostring(ipConfigurations.properties.privateIPAddress)\\r\\n| extend PrivateIPAllocation = tostring(ipConfigurations.properties.privateIPAllocationMethod)\\r\\n| extend SubnetId = ipConfigurations.properties.subnet.id\\r\\n| project-away kind, managedBy, plan, sku, properties, identity, zones, extendedLocation, ipConfigurations, PIPid, PIPid1, tags, tenantId, name, resourceGroup\",\"size\":0,\"title\":\"Azure Firewalls\",\"noDataMessage\":\"No Azure Firewalls were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"ResourceGroup\",\"formatter\":14,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"SubnetId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"ResourceGroup\",\"label\":\"Resource Group\"},{\"columnId\":\"FirewallSKU\",\"label\":\"Firewall SKU\"},{\"columnId\":\"ThreatIntelMode\",\"label\":\"Threat Intel Mode\"},{\"columnId\":\"DNSConfig\",\"label\":\"DNS Config\"},{\"columnId\":\"PublicIPAddress\",\"label\":\"Public IP Address\"},{\"columnId\":\"PrivateIP\",\"label\":\"Private IP\"},{\"columnId\":\"PrivateIPAllocation\",\"label\":\"Private IP Allocation\"},{\"columnId\":\"SubnetId\",\"label\":\"Subnet\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"Firewall\"},\"name\":\"AzureFirewalls\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/firewallpolicies\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend PolicySKU = tostring(properties.sku.tier)\\r\\n| extend Firewalls = properties.firewalls\\r\\n| extend RCGroups = properties.ruleCollectionGroups\\r\\n| mvexpand bagexpansion=array RCGroups, Firewalls\\r\\n| extend FirewallId = Firewalls.id\\r\\n| extend RuleCollectionGroups = RCGroups.id\\r\\n| extend ThreatIntelMode = tostring(properties.threatIntelMode)\\r\\n| extend TIAllowListFQDNs = tostring(properties.threatIntelWhitelist.fqdns)\\r\\n| extend TIAllowListIPs = properties.threatIntelWhitelist.ipAddresses\\r\\n| extend CustomDNSServers = tostring(properties.dnsSettings.servers)\\r\\n| extend DNSProxy = tostring(properties.dnsSettings.enableProxy)\\r\\n| extend IDPSMode = tostring(properties.intrusionDetection.mode)\\r\\n| extend IDPSBypass = tostring(properties.intrusionDetection.configuration.bypassTrafficSettings)\\r\\n| extend IDPSSignatureRules = tostring(properties.intrusionDetection.configuration.signatureOverrides)\\r\\n| extend TLSInspectionCertName = tostring(properties.transportSecurity.certificateAuthority.name)\\r\\n| extend TLSInspectionKVSecret = tostring(properties.transportSecurity.certificateAuthority.keyVaultSecretId)\\r\\n| extend LoggingEnabled = tostring(properties.insights.isEnabled)\\r\\n| extend LogAnalyticsWorkspace = properties.insights.logAnalyticsResources.defaultWorkspaceId.id\\r\\n| project-away kind, managedBy, sku, plan, properties, zones, extendedLocation, tenantId, tags, identity, name, RCGroups, Firewalls, resourceGroup\",\"size\":0,\"title\":\"Standard and Premium Firewall Policies\",\"noDataMessage\":\"No Azure Firewalls Policies were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"FirewallId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"RuleCollectionGroups\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"LogAnalyticsWorkspace\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"PolicySKU\",\"label\":\"Policy SKU\"},{\"columnId\":\"FirewallId\"},{\"columnId\":\"RuleCollectionGroups\"},{\"columnId\":\"ThreatIntelMode\"},{\"columnId\":\"TIAllowListFQDNs\"},{\"columnId\":\"TIAllowListIPs\"},{\"columnId\":\"CustomDNSServers\"},{\"columnId\":\"DNSProxy\"},{\"columnId\":\"IDPSMode\"},{\"columnId\":\"IDPSBypass\"},{\"columnId\":\"IDPSSignatureRules\"},{\"columnId\":\"TLSInspectionCertName\"},{\"columnId\":\"TLSInspectionKVSecret\"},{\"columnId\":\"LoggingEnabled\"},{\"columnId\":\"LogAnalyticsWorkspace\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"Firewall\"},\"name\":\"AzureFirewallPolicy\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains 'microsoft.network/Networksecuritygroups'\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend nic = properties.networkInterfaces\\r\\n| mv-expand nic\\r\\n| extend udrulenicid = nic.id\\r\\n| project-away kind, managedBy, identity, zones, name, tenantId, tags, extendedLocation, properties, sku, plan, nic, resourceGroup\",\"size\":0,\"title\":\"Network Security Groups\",\"noDataMessage\":\"No NSGs were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"udrulenicid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"rowLimit\":5000,\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"udrulenicid\",\"label\":\"Attached NIC\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"NSG\"},\"name\":\"NSGs\"}]},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"NetSecSvcView\"},\"name\":\"NetSecSvcGroup\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"9a80c38d-b158-4483-9380-bcdfd898dc79\",\"cellValue\":\"SelectedSubMenu\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Network Interfaces\",\"subTarget\":\"NIC\",\"style\":\"link\"},{\"id\":\"0f1707b6-87fe-4de0-8077-1b2dd55fc5e0\",\"cellValue\":\"SelectedSubMenu\",\"linkTarget\":\"parameter\",\"linkLabel\":\"VNet with DDoS Protection, Subnets and Peerings\",\"subTarget\":\"VNetDetails\",\"style\":\"link\"},{\"id\":\"751ca64a-7060-4df9-b96d-34061751f1f0\",\"cellValue\":\"SelectedSubMenu\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Route Tables\",\"subTarget\":\"RouteTables\",\"style\":\"link\"},{\"id\":\"d5434924-e545-4442-bdf1-06aab9b787c4\",\"cellValue\":\"SelectedSubMenu\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Private Links\",\"subTarget\":\"PrivateLinks\",\"style\":\"link\"}]},\"name\":\"InternalNetworkingSubMenu\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/networkinterfaces\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend ipConfigurations = properties.ipConfigurations.[0]\\r\\n| extend PrivateIPAddress = tostring(ipConfigurations.properties.privateIPAddress)\\r\\n| extend PublicIPAddressid = ipConfigurations.properties.publicIPAddress.id\\r\\n| extend PrivateIPAddressVersion = tostring(ipConfigurations.properties.privateIPAddressVersion)\\r\\n| extend PrivateIPAllocationMethod = tostring(ipConfigurations.properties.privateIPAllocationMethod)\\r\\n| extend Subnet = ipConfigurations.properties.subnet.id\\r\\n| extend IpConfigid = ipConfigurations.id\\r\\n| extend InternalDNSSuffix = tostring(properties.dnsSettings.internalDomainNameSuffix)\\r\\n| extend NSGid = properties.networkSecurityGroup.id\\r\\n| extend VMid = properties.virtualMachine.id\\r\\n| extend PrivateEndpointId = properties.privateEndpoint.id\\r\\n| extend MacAddress = tostring(properties.macAddress)\\r\\n| extend NicType = tostring(properties.nicType)\\r\\n| project-away kind, managedBy, sku, plan, properties, identity, zones, extendedLocation, ipConfigurations, tenantId, tags, name, resourceGroup\",\"size\":0,\"title\":\"Network Interfaces\",\"noDataMessage\":\"No Network Interfaces were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"PublicIPAddressid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"Subnet\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"IpConfigid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"linkIsContextBlade\":false,\"showIcon\":true}},{\"columnMatch\":\"NSGid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"VMid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true,\"bladeOpenContext\":{\"bladeParameters\":[]}}},{\"columnMatch\":\"PrivateEndpointId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}}],\"rowLimit\":5000,\"filter\":true,\"sortBy\":[{\"itemKey\":\"InternalDNSSuffix\",\"sortOrder\":1}],\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"PrivateIPAddress\",\"label\":\"Private IP Address\"},{\"columnId\":\"PublicIPAddressid\",\"label\":\"Public IP Resource\"},{\"columnId\":\"PrivateIPAddressVersion\"},{\"columnId\":\"PrivateIPAllocationMethod\"},{\"columnId\":\"Subnet\"},{\"columnId\":\"IpConfigid\",\"label\":\"IP Config\"},{\"columnId\":\"InternalDNSSuffix\",\"label\":\"Internal DNS Suffix\"},{\"columnId\":\"NSGid\",\"label\":\"NSG\"},{\"columnId\":\"VMid\",\"label\":\"Virtual Machine\"},{\"columnId\":\"PrivateEndpointId\",\"label\":\"Private Endpoint\"},{\"columnId\":\"MacAddress\",\"label\":\"MAC Address\"},{\"columnId\":\"NicType\"}]},\"sortBy\":[{\"itemKey\":\"InternalDNSSuffix\",\"sortOrder\":1}]},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"NIC\"},\"name\":\"NetworkInterfaces\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/networkinterfaces\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend ipConfigurations = properties.ipConfigurations.[0]\\r\\n| extend PrivateIPAddress = tostring(ipConfigurations.properties.privateIPAddress)\\r\\n| extend PublicIPAddressId = tostring(ipConfigurations.properties.publicIPAddress.id)\\r\\n| extend PrivateIPAddressVersion = tostring(ipConfigurations.properties.privateIPAddressVersion)\\r\\n| extend PrivateIPAllocationMethod = tostring(ipConfigurations.properties.privateIPAllocationMethod)\\r\\n| extend Subnet = ipConfigurations.properties.subnet.id\\r\\n| extend IpConfigId = ipConfigurations.id\\r\\n| extend InternalDNSSuffix = tostring(properties.dnsSettings.internalDomainNameSuffix)\\r\\n| extend NSGId = properties.networkSecurityGroup.id\\r\\n| extend VMId = properties.virtualMachine.id\\r\\n| extend PrivateEndpointId = properties.privateEndpoint.id\\r\\n| extend MacAddress = tostring(properties.macAddress)\\r\\n| extend NicType = tostring(properties.nicType)\\r\\n| join ( Resources | where type=='microsoft.network/publicipaddresses' | extend PublicIP=tostring(properties.ipAddress) | project PublicIPAddressId=id, PublicIP ) on PublicIPAddressId\\r\\n| project-away kind, managedBy, sku, plan, properties, identity, zones, extendedLocation, ipConfigurations, PublicIPAddressId1, tenantId, tags, name, resourceGroup\",\"size\":0,\"title\":\"Network Interfaces with Public IPs\",\"noDataMessage\":\"No Network Interfaces were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"Subnet\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"IpConfigId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"NSGId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"VMId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"PrivateEndpointId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":false}},{\"columnMatch\":\"IpConfigid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"NSGid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"VMid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true,\"templateRunContext\":{\"componentIdSource\":\"parameter\",\"templateUriSource\":\"static\",\"templateParameters\":[],\"titleSource\":\"static\",\"descriptionSource\":\"static\",\"description\":\"\",\"runLabelSource\":\"static\"}}}],\"rowLimit\":5000,\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"PrivateIPAddress\",\"label\":\"Private IP Address\"},{\"columnId\":\"PublicIPAddressId\"},{\"columnId\":\"PrivateIPAddressVersion\"},{\"columnId\":\"PrivateIPAllocationMethod\"},{\"columnId\":\"Subnet\"},{\"columnId\":\"IpConfigId\",\"label\":\"IP Config\"},{\"columnId\":\"InternalDNSSuffix\"},{\"columnId\":\"NSGId\",\"label\":\"NSG\"},{\"columnId\":\"VMId\",\"label\":\"Virtual Machine\"},{\"columnId\":\"PrivateEndpointId\"},{\"columnId\":\"MacAddress\"},{\"columnId\":\"NicType\"},{\"columnId\":\"PublicIP\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"NIC\"},\"name\":\"NetworkInterfacesPIP\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"virtualNetworks\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend DDoSProtectionEnabled = properties.enableDdosProtection\\r\\n| extend DDoSProtectionPlan = properties.ddosProtectionPlan.id\\r\\n| extend VNETAddressRange = properties.addressSpace.addressPrefixes\\r\\n| extend subnets = properties.subnets\\r\\n| mvexpand bagexpansion=array subnets\\r\\n| extend SubnetName = tostring(subnets.name)\\r\\n| extend SubnetAddress = tostring(subnets.properties.addressPrefix)\\r\\n| extend ServiceEndpoints = subnets.properties.serviceEndpoints.[0]\\r\\n| extend SubnetIPConfigid = subnets.properties.ipConfigurations.[0].id\\r\\n| extend VNETPeerings = properties.virtualNetworkPeerings.[0]\\r\\n| extend VNETPeeringName = VNETPeerings.name\\r\\n| extend VNETPeerAddress = VNETPeerings.properties.remoteAddressSpace.addressPrefixes\\r\\n| extend VNETPeerRemoteVNETid = VNETPeerings.properties.remoteVirtualNetwork.id\\r\\n| extend VNETPeeringState = VNETPeerings.properties.peeringState\\r\\n| extend AllowVirtualNetworkAccess = VNETPeerings.properties.allowVirtualNetworkAccess\\r\\n| extend AllowForwardedTraffic = VNETPeerings.properties.allowForwardedTraffic\\r\\n| extend AllowGatewayTransit = VNETPeerings.properties.allowGatewayTransit\\r\\n| project-away kind, managedBy, sku, plan, identity, zones, extendedLocation, properties, subnets, VNETPeerings, tenantId, name, tags, resourceGroup\",\"size\":0,\"title\":\"VNet Details with DDoS Protection, Subnets and Peerings\",\"noDataMessage\":\"No VNETs were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"DDoSProtectionEnabled\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"false\",\"representation\":\"3\"},{\"operator\":\"==\",\"thresholdValue\":\"true\",\"representation\":\"success\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"Blank\",\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"SubnetIPConfigid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"DDoSProtectionEnabled\",\"label\":\"DDoS Protection Enabled\"},{\"columnId\":\"DDoSProtectionPlan\",\"label\":\"DDoS Protection Plan\"},{\"columnId\":\"VNETAddressRange\"},{\"columnId\":\"SubnetName\"},{\"columnId\":\"SubnetAddress\"},{\"columnId\":\"ServiceEndpoints\"},{\"columnId\":\"SubnetIPConfigid\",\"label\":\"Subnet IP Config\"},{\"columnId\":\"VNETPeeringName\"},{\"columnId\":\"VNETPeerAddress\"},{\"columnId\":\"VNETPeerRemoteVNETid\"},{\"columnId\":\"VNETPeeringState\"},{\"columnId\":\"AllowVirtualNetworkAccess\"},{\"columnId\":\"AllowForwardedTraffic\"},{\"columnId\":\"AllowGatewayTransit\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"VNetDetails\"},\"name\":\"VNetDetails\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type == \\\"microsoft.network/routetables\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend SubnetArray = properties.subnets\\r\\n| mvexpand bagexpansion=array SubnetArray\\r\\n| extend Subnetid = SubnetArray.id\\r\\n| extend DisableBGPRoutePropagation = tostring(properties.disableBgpRoutePropagation)\\r\\n| extend RouteArray = properties.routes\\r\\n| mvexpand bagexpansion=array RouteArray\\r\\n| extend RouteName = tostring(RouteArray.name)\\r\\n| extend Routeid = RouteArray.id\\r\\n| extend RouteAddressPrefix = tostring(RouteArray.properties.addressPrefix)\\r\\n| extend RouteHasBGPOverride = tostring(RouteArray.properties.hasBgpOverride)\\r\\n| extend RouteNextHopType = tostring(RouteArray.properties.nextHopType)\\r\\n| project-away kind, managedBy, sku, plan, properties, identity, zones, extendedLocation, SubnetArray, RouteArray, name, tenantId, tags, resourceGroup\\r\\n\",\"size\":0,\"title\":\"Route Tables\",\"noDataMessage\":\"No Route Tables were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"Subnetid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true,\"templateRunContext\":{\"componentIdSource\":\"parameter\",\"templateUriSource\":\"static\",\"templateParameters\":[],\"titleSource\":\"static\",\"descriptionSource\":\"static\",\"description\":\"\",\"runLabelSource\":\"static\"}}},{\"columnMatch\":\"Routeid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"Subnetid\",\"label\":\"Subnet Id\"},{\"columnId\":\"DisableBGPRoutePropagation\"},{\"columnId\":\"RouteName\",\"label\":\"Route Name\"},{\"columnId\":\"Routeid\",\"label\":\"Route Id\"},{\"columnId\":\"RouteAddressPrefix\"},{\"columnId\":\"RouteHasBGPOverride\"},{\"columnId\":\"RouteNextHopType\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"RouteTables\"},\"name\":\"RouteTables\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type == \\\"microsoft.network/privateendpoints\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend NetworkInterfaces = properties.networkInterfaces.[0].id\\r\\n| extend Subnet = properties.subnet.id\\r\\n| extend ManualPrivateLinkServiceConnections = tostring(properties.manualPrivateLinkServiceConnections)\\r\\n| extend PrivateLinkServiceid = properties.privateLinkServiceConnections.[0].properties.privateLinkServiceId\\r\\n| extend PrivateLinkServiceGroupids = tostring(properties.privateLinkServiceConnections.[0].properties.groupIds)\\r\\n| extend PivateLinkServiceConnections = properties.privateLinkServiceConnections.[0].id\\r\\n| extend PrivateLinkCustomDNS = tostring(properties.customDnsConfigs)\\r\\n| project-away kind, managedBy, sku, plan, properties, identity, zones, extendedLocation, tags, tenantId, name, resourceGroup\",\"size\":0,\"title\":\"Private Links\",\"noDataMessage\":\"No Private Links were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"subscriptionId\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"NetworkInterfaces\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"Subnet\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}},{\"columnMatch\":\"PrivateLinkServiceid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true,\"templateRunContext\":{\"componentIdSource\":\"parameter\",\"templateUriSource\":\"static\",\"templateParameters\":[],\"titleSource\":\"static\",\"descriptionSource\":\"static\",\"description\":\"\",\"runLabelSource\":\"static\"}}},{\"columnMatch\":\"PivateLinkServiceConnections\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"NetworkInterfaces\",\"label\":\"Network Interfaces\"},{\"columnId\":\"Subnet\"},{\"columnId\":\"ManualPrivateLinkServiceConnections\"},{\"columnId\":\"PrivateLinkServiceid\"},{\"columnId\":\"PrivateLinkServiceGroupids\"},{\"columnId\":\"PivateLinkServiceConnections\"},{\"columnId\":\"PrivateLinkCustomDNS\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"SelectedSubMenu\",\"comparison\":\"isEqualTo\",\"value\":\"PrivateLinks\"},\"name\":\"PrivateLinks\"}]},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"InternalNetworkingView\"},\"name\":\"InternalNetworkingGroup\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/bastionhosts\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend DNSName = tostring(properties.dnsName)\\r\\n| extend ipConfigurations = properties.ipConfigurations.[0]\\r\\n| extend privateIPAllocationMethod = tostring(ipConfigurations.properties.privateIPAllocationMethod)\\r\\n| extend PIPid = tostring(ipConfigurations.properties.publicIPAddress.id)\\r\\n| join ( Resources | where type=='microsoft.network/publicipaddresses' | extend frontendPublicIPAddress=tostring(properties.ipAddress) | project PIPid=id,frontendPublicIPAddress ) on PIPid\\r\\n| project-away kind, managedBy, sku, plan, properties, identity, zones, extendedLocation, ipConfigurations, PIPid, PIPid1, tags, tenantId, name, resourceGroup\",\"size\":0,\"title\":\"Bastion Hosts\",\"noDataMessage\":\"No Bastion Hosts were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"DNSName\",\"label\":\"DNS Name\"},{\"columnId\":\"privateIPAllocationMethod\",\"label\":\"Private IP Allocation Method\"},{\"columnId\":\"frontendPublicIPAddress\",\"label\":\"Frontend Public IP Address\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"GatewayVPNView\"},\"name\":\"BastionHosts\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/vpngateways\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend ipConfigurations = properties.ipConfigurations\\r\\n| mv-expand bagexpansion=array ipConfigurations\\r\\n| extend instanceid = tostring(ipConfigurations.id)\\r\\n| extend publicIP = tostring(ipConfigurations.publicIpAddress)\\r\\n| extend privateIP = tostring(ipConfigurations.privateIpAddress)\\r\\n| extend virtualHubid = tostring(properties.virtualHub.id)\\r\\n| extend natRules = tostring(properties.natRules)\\r\\n| project-away kind, managedBy, sku, plan, identity, zones, extendedLocation, ipConfigurations, properties, tenantId, tags, name, resourceGroup\",\"size\":0,\"title\":\"VPN Gateways\",\"noDataMessage\":\"No VPN Gateways were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"instanceid\",\"label\":\"Instance\"},{\"columnId\":\"publicIP\",\"label\":\"Public IP\"},{\"columnId\":\"privateIP\",\"label\":\"Private IP\"},{\"columnId\":\"virtualHubid\",\"label\":\"Virtual Hub\"},{\"columnId\":\"natRules\",\"label\":\"NAT Rules\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"GatewayVPNView\"},\"name\":\"VPNGateways\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/virtualnetworkgateways\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend ipConfigurations = properties.ipConfigurations\\r\\n| mv-expand bagexpansion=array ipConfigurations\\r\\n| extend PIPid = tostring(ipConfigurations.properties.publicIPAddress.id)\\r\\n| join ( Resources | where type=='microsoft.network/publicipaddresses' | extend frontendPublicIPAddress=tostring(properties.ipAddress) | project PIPid=id,frontendPublicIPAddress ) on PIPid\\r\\n| extend Subnetid = ipConfigurations.properties.subnet.id\\r\\n| extend privateIPAllocation = tostring(ipConfigurations.properties.privateIPAllocationMethod)\\r\\n| extend gatewayType = tostring(properties.gatewayType)\\r\\n| extend vpnType = tostring(properties.vpnType)\\r\\n| extend skuName = tostring(properties.sku.name)\\r\\n| extend skuTier = tostring(properties.sku.tier)\\r\\n| extend skuCapacity = tostring(properties.sku.capacity)\\r\\n| project-away PIPid, PIPid1, extendedLocation, zones, identity, managedBy, sku, plan, kind, ipConfigurations, properties, tenantId, tags, name, resourceGroup\",\"size\":0,\"title\":\"Virtual Network Gateways\",\"noDataMessage\":\"No Virtual Network Gateways were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"Subnetid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":\"Resource\",\"showIcon\":true}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"frontendPublicIPAddress\",\"label\":\"Frontend Public IP Address\"},{\"columnId\":\"Subnetid\",\"label\":\"Subnet\"},{\"columnId\":\"privateIPAllocation\",\"label\":\"Private IP Allocation\"},{\"columnId\":\"gatewayType\",\"label\":\"Gateway Type\"},{\"columnId\":\"vpnType\",\"label\":\"VPN Type\"},{\"columnId\":\"skuName\",\"label\":\"SKU Name\"},{\"columnId\":\"skuTier\",\"label\":\"SKU Tier\"},{\"columnId\":\"skuCapacity\",\"label\":\"SKU Capacity\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"GatewayVPNView\"},\"name\":\"VirtualNetworkGateways\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains \\\"microsoft.network/expressroutecircuits\\\"\\r\\n| extend ServiceProviderProvisioningState = tostring(properties.serviceProviderProvisioningState)\\r\\n| extend ServiceProviderName = tostring(properties.serviceProviderProperties.serviceProviderName)\\r\\n| extend BandwidthInMbps = tostring(properties.serviceProviderProperties.bandwidthInMbps)\\r\\n| extend PeeringLocation = tostring(properties.serviceProviderProperties.peeringLocation)\\r\\n| extend CircuitProvisioningState = tostring(properties.circuitProvisioningState)\\r\\n| extend ServiceKey = tostring(properties.serviceKey)\\r\\n| extend peerings = properties.peerings.[0].properties\\r\\n| extend PeeringState = tostring(peerings.state)\\r\\n| extend PrimaryPeerAddressPrefix = tostring(peerings.primaryPeerAddressPrefix)\\r\\n| extend SecondaryPeerAddressPrefix = tostring(peerings.secondaryPeerAddressPrefix)\\r\\n| extend PeeringType = tostring(peerings.peeringType)\\r\\n| extend AzureASN = tostring(peerings.azureASN)\\r\\n| extend PeerASN = tostring(peerings.peerASN)\\r\\n| extend VlanId = tostring(peerings.vlanId)\\r\\n| project-away kind, managedBy, plan, properties, identity, zones, extendedLocation, peerings, tenantId, sku, tags, name\",\"size\":0,\"title\":\"Express Route Circuits\",\"noDataMessage\":\"No Express Route Circuits were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"location\",\"formatter\":17},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"ServiceProviderProvisioningState\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"Provisioned\",\"representation\":\"Available\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"NotProvisioned\",\"representation\":\"uninitialized\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"Blank\",\"text\":\"{0}{1}\"}],\"compositeBarSettings\":{\"labelText\":\"\",\"columnSettings\":[]}}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"location\",\"label\":\"Region\"},{\"columnId\":\"resourceGroup\",\"label\":\"Resource Group\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"}]},\"sortBy\":[]},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"GatewayVPNView\"},\"name\":\"ExpressRouteCircuits\"}]},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"GatewayVPNView\"},\"name\":\"GatewayVPNGroup\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type == \\\"microsoft.network/trafficmanagerprofiles\\\"\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend FQDN = tostring(properties.dnsConfig.fqdn)\\r\\n| extend RelativeName = tostring(properties.dnsConfig.relativeName)\\r\\n| extend DNSTTL = tostring(properties.dnsConfig.ttl)\\r\\n| extend endpoints = properties.endpoints\\r\\n| mvexpand bagexpansion=array endpoints\\r\\n| extend TargetResourceid = endpoints.properties.targetResourceId\\r\\n| extend Target = tostring(endpoints.properties.target)\\r\\n| extend Priority = tostring(endpoints.properties.priority)\\r\\n| extend Weight = tostring(endpoints.properties.weight)\\r\\n| extend EndpointLocation = tostring(endpoints.properties.endpointLocation)\\r\\n| extend EndpointName = tostring(endpoints.name)\\r\\n| extend EndpointStatus = tostring(endpoints.properties.endpointMonitorStatus)\\r\\n| extend Endpointid = endpoints.id\\r\\n| extend TrafficRoutingMethod = tostring(properties.trafficRoutingMethod)\\r\\n| extend ProfileStatus = tostring(properties.profileStatus)\\r\\n| extend Protocol = tostring(properties.monitorConfig.protocol)\\r\\n| extend Port = tostring(properties.monitorConfig.port)\\r\\n| extend Path = tostring(properties.monitorConfig.path)\\r\\n| extend TimeoutInSeconds = tostring(properties.monitorConfig.timeoutInSeconds)\\r\\n| extend IntervalInSeconds = tostring(properties.monitorConfig.intervalInSeconds)\\r\\n| extend MonitorStatus = tostring(properties.monitorConfig.profileMonitorStatus)\\r\\n| extend NumberOfFailuresTolerated = tostring(properties.monitorConfig.toleratedNumberOfFailures)\\r\\n| project-away kind, managedBy, sku, plan, identity, zones, extendedLocation, endpoints, properties, name, tenantId, location, tags, resourceGroup\",\"size\":0,\"title\":\"Traffic Manager Profiles\",\"noDataMessage\":\"No Traffic Manager Profiles were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},{\"columnMatch\":\"subscriptionId\",\"formatter\":15,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"TargetResourceid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"EndpointStatus\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"Stopped\",\"representation\":\"stopped\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"Degraded\",\"representation\":\"Degraded\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"Online\",\"representation\":\"success\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"Disabled\",\"representation\":\"disabled\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"Blank\",\"text\":\"{0}{1}\"}]}},{\"columnMatch\":\"Endpointid\",\"formatter\":13,\"formatOptions\":{\"linkTarget\":null,\"showIcon\":true}},{\"columnMatch\":\"MonitorStatus\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"Online\",\"representation\":\"success\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"Degraded\",\"representation\":\"Degraded\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"Blank\",\"text\":\"{0}{1}\"}]}}],\"filter\":true,\"labelSettings\":[{\"columnId\":\"id\",\"label\":\"Name\"},{\"columnId\":\"type\",\"label\":\"Type\"},{\"columnId\":\"subscriptionId\",\"label\":\"Subscription\"},{\"columnId\":\"RG\",\"label\":\"Resource Group\"},{\"columnId\":\"FQDN\"},{\"columnId\":\"RelativeName\",\"label\":\"Relative Name\"},{\"columnId\":\"DNSTTL\",\"label\":\"DNS TTL\"},{\"columnId\":\"TargetResourceid\",\"label\":\"Target Resource\"},{\"columnId\":\"Target\"},{\"columnId\":\"Priority\"},{\"columnId\":\"Weight\"},{\"columnId\":\"EndpointLocation\",\"label\":\"Endpoint Location\"},{\"columnId\":\"EndpointName\",\"label\":\"Endpoint Name\"},{\"columnId\":\"EndpointStatus\",\"label\":\"Endpoint Status\"},{\"columnId\":\"Endpointid\",\"label\":\"Endpoint\"},{\"columnId\":\"TrafficRoutingMethod\",\"label\":\"Traffic Routing Method\"},{\"columnId\":\"ProfileStatus\",\"label\":\"Profile Status\"},{\"columnId\":\"Protocol\"},{\"columnId\":\"Port\"},{\"columnId\":\"Path\"},{\"columnId\":\"TimeoutInSeconds\",\"label\":\"Timeout In Seconds\"},{\"columnId\":\"IntervalInSeconds\",\"label\":\"Interval In Seconds\"},{\"columnId\":\"MonitorStatus\",\"label\":\"Monitor Status\"},{\"columnId\":\"NumberOfFailuresTolerated\",\"label\":\"Number of Failures Tolerated\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"TrafficManagerView\"},\"name\":\"TrafficManager\"},{\"type\":1,\"content\":{\"json\":\"This view presents all current unhealthy recommendations on Security Center which are network related. To view unhealthy resources, click on the recommendation name below.\",\"style\":\"info\"},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"RecommendationsView\"},\"name\":\"RecommendationsBanner\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"securityresources\\r\\n| where type =~ \\\"microsoft.security/assessments\\\"\\r\\n| where properties.status.code == \\\"Unhealthy\\\"\\r\\n| extend ResourceId = tolower(tostring(properties.resourceDetails.Id))\\r\\n| project DisplayName = tostring(properties.displayName),\\r\\nResourceId = tolower(properties.resourceDetails.Id),\\r\\nname,\\r\\nSeverity = tostring(properties.metadata.severity),\\r\\nSeverityRank = case(\\r\\n    properties.metadata.severity == 'High', 3,\\r\\n    properties.metadata.severity == 'Medium', 2,\\r\\n    properties.metadata.severity == 'Low', 1,\\r\\n    0\\r\\n    ),\\r\\nResourceType = tostring(split(id, \\\"/\\\")[6])\\r\\n| join kind=inner (securityresources\\r\\n| where type == 'microsoft.security/securescores/securescorecontrols'\\r\\n| extend AssessmentDefinitions = parse_json(properties.definition.properties.assessmentDefinitions)\\r\\n| mvexpand AssessmentDefinitions\\r\\n| extend name = tostring(split(AssessmentDefinitions.id, \\\"/\\\")[4])) on name\\r\\n| where ResourceType in ('microsoft.web', 'Microsoft.Network')\\r\\n| summarize ResourceCount = count() by DisplayName, name, ControlName = tostring(properties.displayName), SeverityRank, Severity\\r\\n| sort by SeverityRank, ResourceCount desc\",\"size\":0,\"noDataMessage\":\"No security recommendations were found\",\"showExportToExcel\":true,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"DisplayName\",\"formatter\":7,\"formatOptions\":{\"linkTarget\":\"OpenBlade\",\"bladeOpenContext\":{\"bladeName\":\"RecommendationsBlade\",\"extensionName\":\"Microsoft_Azure_Security\",\"bladeParameters\":[{\"name\":\"assessmentKey\",\"source\":\"column\",\"value\":\"name\"}]},\"customColumnWidthSetting\":\"80ch\"}},{\"columnMatch\":\"name\",\"formatter\":5},{\"columnMatch\":\"SeverityRank\",\"formatter\":5},{\"columnMatch\":\"Severity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"Medium\",\"representation\":\"2\"},{\"operator\":\"==\",\"thresholdValue\":\"High\",\"representation\":\"4\"},{\"operator\":\"==\",\"thresholdValue\":\"Low\",\"representation\":\"info\"},{\"operator\":\"Default\",\"thresholdValue\":null,\"representation\":\"success\",\"text\":\"{0}{1}\"}],\"compositeBarSettings\":{\"labelText\":\"\",\"columnSettings\":[]}}},{\"columnMatch\":\"ResourceCount\",\"formatter\":3,\"formatOptions\":{\"palette\":\"red\"}}],\"rowLimit\":1000,\"filter\":true,\"labelSettings\":[{\"columnId\":\"DisplayName\",\"label\":\"Recommendation name\"},{\"columnId\":\"name\"},{\"columnId\":\"ControlName\",\"label\":\"Control name\"},{\"columnId\":\"SeverityRank\"},{\"columnId\":\"Severity\"},{\"columnId\":\"ResourceCount\",\"label\":\"Resource count\"}]}},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"RecommendationsView\"},\"name\":\"Recommendations\"},{\"type\":1,\"content\":{\"json\":\"#### Summary\"},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"Overview\"},\"name\":\"Summary\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"Resources\\r\\n| where type contains 'publicIPAddresses' and isnotempty(properties.ipAddress)\\r\\n| extend publicipaddress = tostring(properties.ipAddress)\\r\\n| extend RG = substring(id, 0, indexof(id, '/providers'))\\r\\n| extend pipallocationmethod = tostring(properties.publicIPAllocationMethod)\\r\\n| extend sku = tostring(sku.name)\\r\\n| extend ipConfiguration = parse_json(properties.ipConfiguration.id)\\r\\n| extend BrkipConfig = split(ipConfiguration, '/')\\r\\n| extend assetprovider = tostring(BrkipConfig[6])\\r\\n| extend typeassetassociatedwith = iif(isempty(tostring(BrkipConfig[7])),\\\"not associated\\\",tostring(BrkipConfig[7]))\\r\\n| extend nameassetassociatedwith = substring(properties.ipConfiguration.id, 0, indexof(properties.ipConfiguration.id, '/ipConfigurations'))\\r\\n| extend dnsname = tostring(properties.dnsSettings.fqdn)\\r\\n| summarize count() by typeassetassociatedwith\",\"size\":1,\"title\":\"Public IP by Resource Type\",\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"visualization\":\"piechart\",\"chartSettings\":{\"showMetrics\":false,\"showLegend\":true}},\"customWidth\":\"40\",\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"Overview\"},\"name\":\"PublicIPbyType\",\"styleSettings\":{\"maxWidth\":\"40\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"securityresources\\r\\n| where type =~ \\\"microsoft.security/assessments\\\"\\r\\n| where properties.status.code == \\\"Unhealthy\\\"\\r\\n| extend ResourceId = tolower(tostring(properties.resourceDetails.Id)),\\r\\nResourceType = tostring(split(id, \\\"/\\\")[6])\\r\\n| join kind=inner (securityresources\\r\\n| where type == 'microsoft.security/securescores/securescorecontrols'\\r\\n| extend AssessmentDefinitions = parse_json(properties.definition.properties.assessmentDefinitions)\\r\\n| mvexpand AssessmentDefinitions\\r\\n| extend name = tostring(split(AssessmentDefinitions.id, \\\"/\\\")[4])) on name\\r\\n| where ResourceType in ('microsoft.web', 'Microsoft.Network')\\r\\n| summarize count() by type\",\"size\":4,\"title\":\"Security Center | Unhealthy Network Resources\",\"color\":\"red\",\"noDataMessage\":\"No unhealthy network resources were found\",\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"min\":0,\"palette\":\"green\"}},\"showBorder\":false}},\"customWidth\":\"30\",\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"Overview\"},\"name\":\"UnhealthyResources\",\"styleSettings\":{\"maxWidth\":\"30\",\"showBorder\":true}},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"resources\\r\\n| where type in ('microsoft.network/publicipaddresses',\\r\\n 'microsoft.network/ddosprotectionplans',\\r\\n 'microsoft.network/virtualnetworks',\\r\\n 'microsoft.network/azurefirewalls',\\r\\n 'microsoft.network/firewallpolicies',\\r\\n 'microsoft.network/loadbalancers',\\r\\n 'microsoft.network/bastionhosts',\\r\\n 'microsoft.network/routetables',\\r\\n 'microsoft.network/networksecuritygroups',\\r\\n 'microsoft.network/frontdoors',\\r\\n 'microsoft.network/frontdoorwebapplicationfirewallpolicies',\\r\\n 'microsoft.network/networkinterfaces',\\r\\n 'microsoft.network/virtualnetworks',\\r\\n 'microsoft.network/trafficmanagerprofiles',\\r\\n 'microsoft.network/privateendpoints',\\r\\n 'microsoft.network/applicationgateways',\\r\\n 'microsoft.network/applicationgatewaywebapplicationfirewallpolicies',\\r\\n 'microsoft.network/virtualnetworkgateways',\\r\\n 'microsoft.network/expressroutecircuits')\\r\\n| summarize count() by type\",\"size\":0,\"queryType\":1,\"resourceType\":\"microsoft.resourcegraph/resources\",\"crossComponentResources\":[\"{Subscription}\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"type\",\"formatter\":16,\"formatOptions\":{\"showIcon\":true}},\"leftContent\":{\"columnMatch\":\"count_\",\"formatter\":12,\"formatOptions\":{\"palette\":\"auto\"},\"numberFormat\":{\"unit\":17,\"options\":{\"style\":\"decimal\",\"maximumFractionDigits\":2,\"maximumSignificantDigits\":3}}},\"showBorder\":true}},\"conditionalVisibility\":{\"parameterName\":\"SelectedView\",\"comparison\":\"isEqualTo\",\"value\":\"Overview\"},\"name\":\"SummaryTiles\"}],\"isLocked\":false,\"fallbackResourceIds\":[\"Azure Security Center\"]}",
        "version": "Notebook/1.0",
        "category": "workbook",
        "sourceId": "Azure Security Center"
        }
      }
    ]
  }